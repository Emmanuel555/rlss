#include <cmath>
#include <vector>
#include "bezier_mathematica.h"
#include <iostream>
using namespace std;


vector<double> bezier_gradient_2d_8pts(double a, double b, vector<vectoreuc>& R, double duration) {
  vector<double> res(R.size()*R[0].size());
  res[0] = -2*a*R[0][0] + 7*pow(a,2)*R[0][0] + 2*b*R[0][0] - 7*pow(b,2)*R[0][0] + 7*pow(a,2)*(R[0][0] - R[1][0]) - 7*pow(b,2)*(R[0][0] - R[1][0]) - (7*pow(a,3)*(26*R[0][0] - 26*R[1][0] + 6*R[2][0]))/3. +
    (7*pow(b,3)*(26*R[0][0] - 26*R[1][0] + 6*R[2][0]))/3. + (7*pow(a,4)*(52*R[0][0] - 78*R[1][0] + 36*R[2][0] - 5*R[3][0]))/2. - (7*pow(b,4)*(52*R[0][0] - 78*R[1][0] + 36*R[2][0] - 5*R[3][0]))/2. -
    (7*pow(a,5)*(286*R[0][0] - 2*(286*R[1][0] - 198*R[2][0] + 55*R[3][0] - 5*R[4][0])))/5. + (7*pow(b,5)*(286*R[0][0] - 2*(286*R[1][0] - 198*R[2][0] + 55*R[3][0] - 5*R[4][0])))/5. +
    (7*pow(a,6)*(286*R[0][0] - 715*R[1][0] + 660*R[2][0] - 275*R[3][0] + 50*R[4][0] - 3*R[5][0]))/3. - (7*pow(b,6)*(286*R[0][0] - 715*R[1][0] + 660*R[2][0] - 275*R[3][0] + 50*R[4][0] - 3*R[5][0]))/3. +
    pow(a,14)*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) - pow(b,14)*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) -
    pow(a,7)*(858*R[0][0] + 2*(-1287*R[1][0] + 1485*R[2][0] - 825*R[3][0] + 225*R[4][0] - 27*R[5][0] + R[6][0])) +
    pow(b,7)*(858*R[0][0] + 2*(-1287*R[1][0] + 1485*R[2][0] - 825*R[3][0] + 225*R[4][0] - 27*R[5][0] + R[6][0])) +
    (7*pow(a,12)*(52*R[0][0] - 286*R[1][0] + 660*R[2][0] - 825*R[3][0] + 600*R[4][0] - 252*R[5][0] + 56*R[6][0] - 5*R[7][0]))/6. -
    (7*pow(b,12)*(52*R[0][0] - 286*R[1][0] + 660*R[2][0] - 825*R[3][0] + 600*R[4][0] - 252*R[5][0] + 56*R[6][0] - 5*R[7][0]))/6. +
    (7*pow(a,10)*(286*R[0][0] - 1287*R[1][0] + 2376*R[2][0] - 2310*R[3][0] + 1260*R[4][0] - 378*R[5][0] + 56*R[6][0] - 3*R[7][0]))/5. -
    (7*pow(b,10)*(286*R[0][0] - 1287*R[1][0] + 2376*R[2][0] - 2310*R[3][0] + 1260*R[4][0] - 378*R[5][0] + 56*R[6][0] - 3*R[7][0]))/5. +
    pow(a,14)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) -
    (2*pow(a,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/15. -
    pow(b,14)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) +
    (2*pow(b,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/15. +
    (pow(a,8)*(3432*R[0][0] - 12012*R[1][0] + 16632*R[2][0] - 11550*R[3][0] + 4200*R[4][0] - 756*R[5][0] + 56*R[6][0] - R[7][0]))/4. -
    (pow(b,8)*(3432*R[0][0] - 12012*R[1][0] + 16632*R[2][0] - 11550*R[3][0] + 4200*R[4][0] - 756*R[5][0] + 56*R[6][0] - R[7][0]))/4. -
    (7*pow(a,9)*(858*R[0][0] - 2*(1716*R[1][0] - 2772*R[2][0] + 2310*R[3][0] - 1050*R[4][0] + 252*R[5][0] - 28*R[6][0] + R[7][0])))/9. +
    (7*pow(b,9)*(858*R[0][0] - 2*(1716*R[1][0] - 2772*R[2][0] + 2310*R[3][0] - 1050*R[4][0] + 252*R[5][0] - 28*R[6][0] + R[7][0])))/9. -
    (7*pow(a,13)*(26*R[0][0] - 2*(78*R[1][0] - 198*R[2][0] + 275*R[3][0] - 225*R[4][0] + 108*R[5][0] - 28*R[6][0] + 3*R[7][0])))/13. +
    (7*pow(b,13)*(26*R[0][0] - 2*(78*R[1][0] - 198*R[2][0] + 275*R[3][0] - 225*R[4][0] + 108*R[5][0] - 28*R[6][0] + 3*R[7][0])))/13. -
    (7*pow(a,11)*(286*R[0][0] - 2*(715*R[1][0] - 1485*R[2][0] + 1650*R[3][0] - 1050*R[4][0] + 378*R[5][0] - 70*R[6][0] + 5*R[7][0])))/11. +
    (7*pow(b,11)*(286*R[0][0] - 2*(715*R[1][0] - 1485*R[2][0] + 1650*R[3][0] - 1050*R[4][0] + 378*R[5][0] - 70*R[6][0] + 5*R[7][0])))/11.;





  res[1] =-2*a*R[0][1] + 7*pow(a,2)*R[0][1] + 2*b*R[0][1] - 7*pow(b,2)*R[0][1] + 7*pow(a,2)*(R[0][1] - R[1][1]) - 7*pow(b,2)*(R[0][1] - R[1][1]) - (7*pow(a,3)*(26*R[0][1] - 26*R[1][1] + 6*R[2][1]))/3. +
    (7*pow(b,3)*(26*R[0][1] - 26*R[1][1] + 6*R[2][1]))/3. + (7*pow(a,4)*(52*R[0][1] - 78*R[1][1] + 36*R[2][1] - 5*R[3][1]))/2. - (7*pow(b,4)*(52*R[0][1] - 78*R[1][1] + 36*R[2][1] - 5*R[3][1]))/2. -
    (7*pow(a,5)*(286*R[0][1] - 2*(286*R[1][1] - 198*R[2][1] + 55*R[3][1] - 5*R[4][1])))/5. + (7*pow(b,5)*(286*R[0][1] - 2*(286*R[1][1] - 198*R[2][1] + 55*R[3][1] - 5*R[4][1])))/5. +
    (7*pow(a,6)*(286*R[0][1] - 715*R[1][1] + 660*R[2][1] - 275*R[3][1] + 50*R[4][1] - 3*R[5][1]))/3. - (7*pow(b,6)*(286*R[0][1] - 715*R[1][1] + 660*R[2][1] - 275*R[3][1] + 50*R[4][1] - 3*R[5][1]))/3. +
    pow(a,14)*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) - pow(b,14)*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) -
    pow(a,7)*(858*R[0][1] + 2*(-1287*R[1][1] + 1485*R[2][1] - 825*R[3][1] + 225*R[4][1] - 27*R[5][1] + R[6][1])) +
    pow(b,7)*(858*R[0][1] + 2*(-1287*R[1][1] + 1485*R[2][1] - 825*R[3][1] + 225*R[4][1] - 27*R[5][1] + R[6][1])) +
    (7*pow(a,12)*(52*R[0][1] - 286*R[1][1] + 660*R[2][1] - 825*R[3][1] + 600*R[4][1] - 252*R[5][1] + 56*R[6][1] - 5*R[7][1]))/6. -
    (7*pow(b,12)*(52*R[0][1] - 286*R[1][1] + 660*R[2][1] - 825*R[3][1] + 600*R[4][1] - 252*R[5][1] + 56*R[6][1] - 5*R[7][1]))/6. +
    (7*pow(a,10)*(286*R[0][1] - 1287*R[1][1] + 2376*R[2][1] - 2310*R[3][1] + 1260*R[4][1] - 378*R[5][1] + 56*R[6][1] - 3*R[7][1]))/5. -
    (7*pow(b,10)*(286*R[0][1] - 1287*R[1][1] + 2376*R[2][1] - 2310*R[3][1] + 1260*R[4][1] - 378*R[5][1] + 56*R[6][1] - 3*R[7][1]))/5. +
    pow(a,14)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) -
    (2*pow(a,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/15. -
    pow(b,14)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) +
    (2*pow(b,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/15. +
    (pow(a,8)*(3432*R[0][1] - 12012*R[1][1] + 16632*R[2][1] - 11550*R[3][1] + 4200*R[4][1] - 756*R[5][1] + 56*R[6][1] - R[7][1]))/4. -
    (pow(b,8)*(3432*R[0][1] - 12012*R[1][1] + 16632*R[2][1] - 11550*R[3][1] + 4200*R[4][1] - 756*R[5][1] + 56*R[6][1] - R[7][1]))/4. -
    (7*pow(a,9)*(858*R[0][1] - 2*(1716*R[1][1] - 2772*R[2][1] + 2310*R[3][1] - 1050*R[4][1] + 252*R[5][1] - 28*R[6][1] + R[7][1])))/9. +
    (7*pow(b,9)*(858*R[0][1] - 2*(1716*R[1][1] - 2772*R[2][1] + 2310*R[3][1] - 1050*R[4][1] + 252*R[5][1] - 28*R[6][1] + R[7][1])))/9. -
    (7*pow(a,13)*(26*R[0][1] - 2*(78*R[1][1] - 198*R[2][1] + 275*R[3][1] - 225*R[4][1] + 108*R[5][1] - 28*R[6][1] + 3*R[7][1])))/13. +
    (7*pow(b,13)*(26*R[0][1] - 2*(78*R[1][1] - 198*R[2][1] + 275*R[3][1] - 225*R[4][1] + 108*R[5][1] - 28*R[6][1] + 3*R[7][1])))/13. -
    (7*pow(a,11)*(286*R[0][1] - 2*(715*R[1][1] - 1485*R[2][1] + 1650*R[3][1] - 1050*R[4][1] + 378*R[5][1] - 70*R[6][1] + 5*R[7][1])))/11. +
    (7*pow(b,11)*(286*R[0][1] - 2*(715*R[1][1] - 1485*R[2][1] + 1650*R[3][1] - 1050*R[4][1] + 378*R[5][1] - 70*R[6][1] + 5*R[7][1])))/11.;




   res[2] =-7*pow(a,2)*R[0][0] + 7*pow(b,2)*R[0][0] - (7*pow(a,3)*(-26*R[0][0] + 14*R[1][0]))/3. + (7*pow(b,3)*(-26*R[0][0] + 14*R[1][0]))/3. +
    (7*pow(a,4)*(-78*R[0][0] + 42*R[1][0] + 21*(2*R[1][0] - R[2][0])))/2. - (7*pow(b,4)*(-78*R[0][0] + 42*R[1][0] + 21*(2*R[1][0] - R[2][0])))/2. -
    (7*pow(a,5)*(-572*R[0][0] + 7*(132*R[1][0] - 66*R[2][0] + 10*R[3][0])))/5. + (7*pow(b,5)*(-572*R[0][0] + 7*(132*R[1][0] - 66*R[2][0] + 10*R[3][0])))/5. +
    (7*pow(a,6)*(-715*R[0][0] + 35*(44*R[1][0] - 33*R[2][0] + 10*R[3][0] - R[4][0])))/3. - (7*pow(b,6)*(-715*R[0][0] + 35*(44*R[1][0] - 33*R[2][0] + 10*R[3][0] - R[4][0])))/3. -
    pow(a,7)*(-2574*R[0][0] + 7*(990*R[1][0] + 6*(-165*R[2][0] + 75*R[3][0] - 15*R[4][0] + R[5][0]))) + pow(b,7)*(-2574*R[0][0] + 7*(990*R[1][0] + 6*(-165*R[2][0] + 75*R[3][0] - 15*R[4][0] + R[5][0]))) +
    (pow(a,8)*(-12012*R[0][0] + 49*(792*R[1][0] - 990*R[2][0] + 600*R[3][0] - 180*R[4][0] + 24*R[5][0] - R[6][0])))/4. -
    (pow(b,8)*(-12012*R[0][0] + 49*(792*R[1][0] - 990*R[2][0] + 600*R[3][0] - 180*R[4][0] + 24*R[5][0] - R[6][0])))/4. -
    7*pow(a,14)*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) + 7*pow(b,14)*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) -
    (7*pow(a,13)*(-156*R[0][0] + 924*R[1][0] - 6*(385*R[2][0] - 525*R[3][0] + 420*R[4][0] - 196*R[5][0] + 49*R[6][0] - 5*R[7][0])))/13. +
    (7*pow(b,13)*(-156*R[0][0] + 924*R[1][0] - 6*(385*R[2][0] - 525*R[3][0] + 420*R[4][0] - 196*R[5][0] + 49*R[6][0] - 5*R[7][0])))/13. -
    (7*pow(a,11)*(-1430*R[0][0] + 6930*R[1][0] - 10*(1386*R[2][0] - 1470*R[3][0] + 882*R[4][0] - 294*R[5][0] + 49*R[6][0] - 3*R[7][0])))/11. +
    (7*pow(b,11)*(-1430*R[0][0] + 6930*R[1][0] - 10*(1386*R[2][0] - 1470*R[3][0] + 882*R[4][0] - 294*R[5][0] + 49*R[6][0] - 3*R[7][0])))/11. +
    (7*pow(a,10)*(-1287*R[0][0] + 5544*R[1][0] - 3*(3234*R[2][0] - 2940*R[3][0] + 1470*R[4][0] - 392*R[5][0] + 49*R[6][0] - 2*R[7][0])))/5. -
    (7*pow(b,10)*(-1287*R[0][0] + 5544*R[1][0] - 3*(3234*R[2][0] - 2940*R[3][0] + 1470*R[4][0] - 392*R[5][0] + 49*R[6][0] - 2*R[7][0])))/5. -
    (7*pow(a,9)*(-3432*R[0][0] + 12936*R[1][0] - 2*(9702*R[2][0] - 7350*R[3][0] + 2940*R[4][0] - 588*R[5][0] + 49*R[6][0] - R[7][0])))/9. +
    (7*pow(b,9)*(-3432*R[0][0] + 12936*R[1][0] - 2*(9702*R[2][0] - 7350*R[3][0] + 2940*R[4][0] - 588*R[5][0] + 49*R[6][0] - R[7][0])))/9. -
    6*pow(a,14)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) +
    (14*pow(a,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/15. +
    6*pow(b,14)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) -
    (14*pow(b,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/15. +
    (7*pow(a,12)*(-286*R[0][0] + 1540*R[1][0] - 3465*R[2][0] + 4200*R[3][0] - 2940*R[4][0] + 1176*R[5][0] - 245*R[6][0] + 20*R[7][0]))/6. -
    (7*pow(b,12)*(-286*R[0][0] + 1540*R[1][0] - 3465*R[2][0] + 4200*R[3][0] - 2940*R[4][0] + 1176*R[5][0] - 245*R[6][0] + 20*R[7][0]))/6.;




   res[3] =-7*pow(a,2)*R[0][1] + 7*pow(b,2)*R[0][1] - (7*pow(a,3)*(-26*R[0][1] + 14*R[1][1]))/3. + (7*pow(b,3)*(-26*R[0][1] + 14*R[1][1]))/3. +
    (7*pow(a,4)*(-78*R[0][1] + 42*R[1][1] + 21*(2*R[1][1] - R[2][1])))/2. - (7*pow(b,4)*(-78*R[0][1] + 42*R[1][1] + 21*(2*R[1][1] - R[2][1])))/2. -
    (7*pow(a,5)*(-572*R[0][1] + 7*(132*R[1][1] - 66*R[2][1] + 10*R[3][1])))/5. + (7*pow(b,5)*(-572*R[0][1] + 7*(132*R[1][1] - 66*R[2][1] + 10*R[3][1])))/5. +
    (7*pow(a,6)*(-715*R[0][1] + 35*(44*R[1][1] - 33*R[2][1] + 10*R[3][1] - R[4][1])))/3. - (7*pow(b,6)*(-715*R[0][1] + 35*(44*R[1][1] - 33*R[2][1] + 10*R[3][1] - R[4][1])))/3. -
    pow(a,7)*(-2574*R[0][1] + 7*(990*R[1][1] + 6*(-165*R[2][1] + 75*R[3][1] - 15*R[4][1] + R[5][1]))) + pow(b,7)*(-2574*R[0][1] + 7*(990*R[1][1] + 6*(-165*R[2][1] + 75*R[3][1] - 15*R[4][1] + R[5][1]))) +
    (pow(a,8)*(-12012*R[0][1] + 49*(792*R[1][1] - 990*R[2][1] + 600*R[3][1] - 180*R[4][1] + 24*R[5][1] - R[6][1])))/4. -
    (pow(b,8)*(-12012*R[0][1] + 49*(792*R[1][1] - 990*R[2][1] + 600*R[3][1] - 180*R[4][1] + 24*R[5][1] - R[6][1])))/4. -
    7*pow(a,14)*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) + 7*pow(b,14)*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) -
    (7*pow(a,13)*(-156*R[0][1] + 924*R[1][1] - 6*(385*R[2][1] - 525*R[3][1] + 420*R[4][1] - 196*R[5][1] + 49*R[6][1] - 5*R[7][1])))/13. +
    (7*pow(b,13)*(-156*R[0][1] + 924*R[1][1] - 6*(385*R[2][1] - 525*R[3][1] + 420*R[4][1] - 196*R[5][1] + 49*R[6][1] - 5*R[7][1])))/13. -
    (7*pow(a,11)*(-1430*R[0][1] + 6930*R[1][1] - 10*(1386*R[2][1] - 1470*R[3][1] + 882*R[4][1] - 294*R[5][1] + 49*R[6][1] - 3*R[7][1])))/11. +
    (7*pow(b,11)*(-1430*R[0][1] + 6930*R[1][1] - 10*(1386*R[2][1] - 1470*R[3][1] + 882*R[4][1] - 294*R[5][1] + 49*R[6][1] - 3*R[7][1])))/11. +
    (7*pow(a,10)*(-1287*R[0][1] + 5544*R[1][1] - 3*(3234*R[2][1] - 2940*R[3][1] + 1470*R[4][1] - 392*R[5][1] + 49*R[6][1] - 2*R[7][1])))/5. -
    (7*pow(b,10)*(-1287*R[0][1] + 5544*R[1][1] - 3*(3234*R[2][1] - 2940*R[3][1] + 1470*R[4][1] - 392*R[5][1] + 49*R[6][1] - 2*R[7][1])))/5. -
    (7*pow(a,9)*(-3432*R[0][1] + 12936*R[1][1] - 2*(9702*R[2][1] - 7350*R[3][1] + 2940*R[4][1] - 588*R[5][1] + 49*R[6][1] - R[7][1])))/9. +
    (7*pow(b,9)*(-3432*R[0][1] + 12936*R[1][1] - 2*(9702*R[2][1] - 7350*R[3][1] + 2940*R[4][1] - 588*R[5][1] + 49*R[6][1] - R[7][1])))/9. -
    6*pow(a,14)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) +
    (14*pow(a,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/15. +
    6*pow(b,14)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) -
    (14*pow(b,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/15. +
    (7*pow(a,12)*(-286*R[0][1] + 1540*R[1][1] - 3465*R[2][1] + 4200*R[3][1] - 2940*R[4][1] + 1176*R[5][1] - 245*R[6][1] + 20*R[7][1]))/6. -
    (7*pow(b,12)*(-286*R[0][1] + 1540*R[1][1] - 3465*R[2][1] + 4200*R[3][1] - 2940*R[4][1] + 1176*R[5][1] - 245*R[6][1] + 20*R[7][1]))/6.;




   res[4] =-14*pow(a,3)*R[0][0] + 14*pow(b,3)*R[0][0] + (7*pow(a,4)*(36*R[0][0] - 21*R[1][0]))/2. - (7*pow(b,4)*(36*R[0][0] - 21*R[1][0]))/2. - (7*pow(a,5)*(396*R[0][0] + 7*(-66*R[1][0] + 18*R[2][0])))/5. +
    (7*pow(b,5)*(396*R[0][0] + 7*(-66*R[1][0] + 18*R[2][0])))/5. + (7*pow(a,6)*(660*R[0][0] + 35*(-33*R[1][0] + 9*R[2][0] + 3*(3*R[2][0] - R[3][0]))))/3. -
    (7*pow(b,6)*(660*R[0][0] + 35*(-33*R[1][0] + 9*R[2][0] + 3*(3*R[2][0] - R[3][0]))))/3. - pow(a,7)*(2970*R[0][0] + 7*(-990*R[1][0] + 5*(162*R[2][0] + 6*(-9*R[3][0] + R[4][0])))) +
    pow(b,7)*(2970*R[0][0] + 7*(-990*R[1][0] + 5*(162*R[2][0] + 6*(-9*R[3][0] + R[4][0])))) + (pow(a,8)*(16632*R[0][0] + 49*(-990*R[1][0] + 1080*R[2][0] - 3*(180*R[3][0] - 40*R[4][0] + 3*R[5][0]))))/4. -
    (pow(b,8)*(16632*R[0][0] + 49*(-990*R[1][0] + 1080*R[2][0] - 3*(180*R[3][0] - 40*R[4][0] + 3*R[5][0]))))/4. -
    (7*pow(a,9)*(5544*R[0][0] - 19404*R[1][0] + 7*(3780*R[2][0] - 6*(420*R[3][0] - 140*R[4][0] + 21*R[5][0] - R[6][0]))))/9. +
    (7*pow(b,9)*(5544*R[0][0] - 19404*R[1][0] + 7*(3780*R[2][0] - 6*(420*R[3][0] - 140*R[4][0] + 21*R[5][0] - R[6][0]))))/9. +
    21*pow(a,14)*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) - 21*pow(b,14)*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) -
    (7*pow(a,13)*(396*R[0][0] - 2310*R[1][0] + 5670*R[2][0] - 7560*R[3][0] + 5880*R[4][0] - 2646*R[5][0] + 630*R[6][0] - 60*R[7][0]))/13. +
    (7*pow(b,13)*(396*R[0][0] - 2310*R[1][0] + 5670*R[2][0] - 7560*R[3][0] + 5880*R[4][0] - 2646*R[5][0] + 630*R[6][0] - 60*R[7][0]))/13. +
    (7*pow(a,12)*(660*R[0][0] - 3465*R[1][0] + 7560*R[2][0] - 8820*R[3][0] + 5880*R[4][0] - 2205*R[5][0] + 420*R[6][0] - 30*R[7][0]))/6. -
    (7*pow(b,12)*(660*R[0][0] - 3465*R[1][0] + 7560*R[2][0] - 8820*R[3][0] + 5880*R[4][0] - 2205*R[5][0] + 420*R[6][0] - 30*R[7][0]))/6. -
    (7*pow(a,11)*(2970*R[0][0] - 13860*R[1][0] + 26460*R[2][0] - 26460*R[3][0] + 14700*R[4][0] - 4410*R[5][0] + 630*R[6][0] - 30*R[7][0]))/11. +
    (7*pow(b,11)*(2970*R[0][0] - 13860*R[1][0] + 26460*R[2][0] - 26460*R[3][0] + 14700*R[4][0] - 4410*R[5][0] + 630*R[6][0] - 30*R[7][0]))/11. +
    (7*pow(a,10)*(2376*R[0][0] - 9702*R[1][0] + 15876*R[2][0] - 13230*R[3][0] + 5880*R[4][0] - 1323*R[5][0] + 126*R[6][0] - 3*R[7][0]))/5. -
    (7*pow(b,10)*(2376*R[0][0] - 9702*R[1][0] + 15876*R[2][0] - 13230*R[3][0] + 5880*R[4][0] - 1323*R[5][0] + 126*R[6][0] - 3*R[7][0]))/5. +
    15*pow(a,14)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) -
    (14*pow(a,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/5. -
    15*pow(b,14)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) +
    (14*pow(b,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/5.;




   res[5] =-14*pow(a,3)*R[0][1] + 14*pow(b,3)*R[0][1] + (7*pow(a,4)*(36*R[0][1] - 21*R[1][1]))/2. - (7*pow(b,4)*(36*R[0][1] - 21*R[1][1]))/2. - (7*pow(a,5)*(396*R[0][1] + 7*(-66*R[1][1] + 18*R[2][1])))/5. +
    (7*pow(b,5)*(396*R[0][1] + 7*(-66*R[1][1] + 18*R[2][1])))/5. + (7*pow(a,6)*(660*R[0][1] + 35*(-33*R[1][1] + 9*R[2][1] + 3*(3*R[2][1] - R[3][1]))))/3. -
    (7*pow(b,6)*(660*R[0][1] + 35*(-33*R[1][1] + 9*R[2][1] + 3*(3*R[2][1] - R[3][1]))))/3. - pow(a,7)*(2970*R[0][1] + 7*(-990*R[1][1] + 5*(162*R[2][1] + 6*(-9*R[3][1] + R[4][1])))) +
    pow(b,7)*(2970*R[0][1] + 7*(-990*R[1][1] + 5*(162*R[2][1] + 6*(-9*R[3][1] + R[4][1])))) + (pow(a,8)*(16632*R[0][1] + 49*(-990*R[1][1] + 1080*R[2][1] - 3*(180*R[3][1] - 40*R[4][1] + 3*R[5][1]))))/4. -
    (pow(b,8)*(16632*R[0][1] + 49*(-990*R[1][1] + 1080*R[2][1] - 3*(180*R[3][1] - 40*R[4][1] + 3*R[5][1]))))/4. -
    (7*pow(a,9)*(5544*R[0][1] - 19404*R[1][1] + 7*(3780*R[2][1] - 6*(420*R[3][1] - 140*R[4][1] + 21*R[5][1] - R[6][1]))))/9. +
    (7*pow(b,9)*(5544*R[0][1] - 19404*R[1][1] + 7*(3780*R[2][1] - 6*(420*R[3][1] - 140*R[4][1] + 21*R[5][1] - R[6][1]))))/9. +
    21*pow(a,14)*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) - 21*pow(b,14)*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) -
    (7*pow(a,13)*(396*R[0][1] - 2310*R[1][1] + 5670*R[2][1] - 7560*R[3][1] + 5880*R[4][1] - 2646*R[5][1] + 630*R[6][1] - 60*R[7][1]))/13. +
    (7*pow(b,13)*(396*R[0][1] - 2310*R[1][1] + 5670*R[2][1] - 7560*R[3][1] + 5880*R[4][1] - 2646*R[5][1] + 630*R[6][1] - 60*R[7][1]))/13. +
    (7*pow(a,12)*(660*R[0][1] - 3465*R[1][1] + 7560*R[2][1] - 8820*R[3][1] + 5880*R[4][1] - 2205*R[5][1] + 420*R[6][1] - 30*R[7][1]))/6. -
    (7*pow(b,12)*(660*R[0][1] - 3465*R[1][1] + 7560*R[2][1] - 8820*R[3][1] + 5880*R[4][1] - 2205*R[5][1] + 420*R[6][1] - 30*R[7][1]))/6. -
    (7*pow(a,11)*(2970*R[0][1] - 13860*R[1][1] + 26460*R[2][1] - 26460*R[3][1] + 14700*R[4][1] - 4410*R[5][1] + 630*R[6][1] - 30*R[7][1]))/11. +
    (7*pow(b,11)*(2970*R[0][1] - 13860*R[1][1] + 26460*R[2][1] - 26460*R[3][1] + 14700*R[4][1] - 4410*R[5][1] + 630*R[6][1] - 30*R[7][1]))/11. +
    (7*pow(a,10)*(2376*R[0][1] - 9702*R[1][1] + 15876*R[2][1] - 13230*R[3][1] + 5880*R[4][1] - 1323*R[5][1] + 126*R[6][1] - 3*R[7][1]))/5. -
    (7*pow(b,10)*(2376*R[0][1] - 9702*R[1][1] + 15876*R[2][1] - 13230*R[3][1] + 5880*R[4][1] - 1323*R[5][1] + 126*R[6][1] - 3*R[7][1]))/5. +
    15*pow(a,14)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) -
    (14*pow(a,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/5. -
    15*pow(b,14)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) +
    (14*pow(b,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/5.;




   res[6] =(-35*pow(a,4)*R[0][0])/2. + (35*pow(b,4)*R[0][0])/2. - (7*pow(a,5)*(-110*R[0][0] + 70*R[1][0]))/5. + (7*pow(b,5)*(-110*R[0][0] + 70*R[1][0]))/5. +
    (7*pow(a,6)*(-275*R[0][0] + 35*(10*R[1][0] - 3*R[2][0])))/3. - (7*pow(b,6)*(-275*R[0][0] + 35*(10*R[1][0] - 3*R[2][0])))/3. - pow(a,7)*(-1650*R[0][0] + 7*(450*R[1][0] + 5*(-54*R[2][0] + 10*R[3][0]))) +
    pow(b,7)*(-1650*R[0][0] + 7*(450*R[1][0] + 5*(-54*R[2][0] + 10*R[3][0]))) + (pow(a,8)*(-11550*R[0][0] + 49*(600*R[1][0] - 540*R[2][0] + 100*R[3][0] + 25*(4*R[3][0] - R[4][0]))))/4. -
    (pow(b,8)*(-11550*R[0][0] + 49*(600*R[1][0] - 540*R[2][0] + 100*R[3][0] + 25*(4*R[3][0] - R[4][0]))))/4. -
    (7*pow(a,9)*(-4620*R[0][0] + 14700*R[1][0] + 7*(-2520*R[2][0] + 1400*R[3][0] + 5*(-70*R[4][0] + 6*R[5][0]))))/9. +
    (7*pow(b,9)*(-4620*R[0][0] + 14700*R[1][0] + 7*(-2520*R[2][0] + 1400*R[3][0] + 5*(-70*R[4][0] + 6*R[5][0]))))/9. +
    (7*pow(a,10)*(-2310*R[0][0] + 8820*R[1][0] - 13230*R[2][0] + 9800*R[3][0] - 3675*R[4][0] + 630*R[5][0] - 35*R[6][0]))/5. -
    (7*pow(b,10)*(-2310*R[0][0] + 8820*R[1][0] - 13230*R[2][0] + 9800*R[3][0] - 3675*R[4][0] + 630*R[5][0] - 35*R[6][0]))/5. -
    35*pow(a,14)*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) + 35*pow(b,14)*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) -
    20*pow(a,14)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) +
    (14*pow(a,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/3. +
    20*pow(b,14)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) -
    (14*pow(b,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/3. -
    (7*pow(a,11)*(-3300*R[0][0] + 14700*R[1][0] - 26460*R[2][0] + 24500*R[3][0] - 12250*R[4][0] + 3150*R[5][0] - 350*R[6][0] + 10*R[7][0]))/11. +
    (7*pow(b,11)*(-3300*R[0][0] + 14700*R[1][0] - 26460*R[2][0] + 24500*R[3][0] - 12250*R[4][0] + 3150*R[5][0] - 350*R[6][0] + 10*R[7][0]))/11. +
    (7*pow(a,12)*(-825*R[0][0] + 4200*R[1][0] - 8820*R[2][0] + 9800*R[3][0] - 6125*R[4][0] + 2100*R[5][0] - 350*R[6][0] + 20*R[7][0]))/6. -
    (7*pow(b,12)*(-825*R[0][0] + 4200*R[1][0] - 8820*R[2][0] + 9800*R[3][0] - 6125*R[4][0] + 2100*R[5][0] - 350*R[6][0] + 20*R[7][0]))/6. -
    (7*pow(a,13)*(-550*R[0][0] + 3150*R[1][0] - 7560*R[2][0] + 9800*R[3][0] - 7350*R[4][0] + 3150*R[5][0] - 700*R[6][0] + 60*R[7][0]))/13. +
    (7*pow(b,13)*(-550*R[0][0] + 3150*R[1][0] - 7560*R[2][0] + 9800*R[3][0] - 7350*R[4][0] + 3150*R[5][0] - 700*R[6][0] + 60*R[7][0]))/13.;



   res[7] =(-35*pow(a,4)*R[0][1])/2. + (35*pow(b,4)*R[0][1])/2. - (7*pow(a,5)*(-110*R[0][1] + 70*R[1][1]))/5. + (7*pow(b,5)*(-110*R[0][1] + 70*R[1][1]))/5. +
    (7*pow(a,6)*(-275*R[0][1] + 35*(10*R[1][1] - 3*R[2][1])))/3. - (7*pow(b,6)*(-275*R[0][1] + 35*(10*R[1][1] - 3*R[2][1])))/3. - pow(a,7)*(-1650*R[0][1] + 7*(450*R[1][1] + 5*(-54*R[2][1] + 10*R[3][1]))) +
    pow(b,7)*(-1650*R[0][1] + 7*(450*R[1][1] + 5*(-54*R[2][1] + 10*R[3][1]))) + (pow(a,8)*(-11550*R[0][1] + 49*(600*R[1][1] - 540*R[2][1] + 100*R[3][1] + 25*(4*R[3][1] - R[4][1]))))/4. -
    (pow(b,8)*(-11550*R[0][1] + 49*(600*R[1][1] - 540*R[2][1] + 100*R[3][1] + 25*(4*R[3][1] - R[4][1]))))/4. -
    (7*pow(a,9)*(-4620*R[0][1] + 14700*R[1][1] + 7*(-2520*R[2][1] + 1400*R[3][1] + 5*(-70*R[4][1] + 6*R[5][1]))))/9. +
    (7*pow(b,9)*(-4620*R[0][1] + 14700*R[1][1] + 7*(-2520*R[2][1] + 1400*R[3][1] + 5*(-70*R[4][1] + 6*R[5][1]))))/9. +
    (7*pow(a,10)*(-2310*R[0][1] + 8820*R[1][1] - 13230*R[2][1] + 9800*R[3][1] - 3675*R[4][1] + 630*R[5][1] - 35*R[6][1]))/5. -
    (7*pow(b,10)*(-2310*R[0][1] + 8820*R[1][1] - 13230*R[2][1] + 9800*R[3][1] - 3675*R[4][1] + 630*R[5][1] - 35*R[6][1]))/5. -
    35*pow(a,14)*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) + 35*pow(b,14)*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) -
    20*pow(a,14)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) +
    (14*pow(a,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/3. +
    20*pow(b,14)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) -
    (14*pow(b,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/3. -
    (7*pow(a,11)*(-3300*R[0][1] + 14700*R[1][1] - 26460*R[2][1] + 24500*R[3][1] - 12250*R[4][1] + 3150*R[5][1] - 350*R[6][1] + 10*R[7][1]))/11. +
    (7*pow(b,11)*(-3300*R[0][1] + 14700*R[1][1] - 26460*R[2][1] + 24500*R[3][1] - 12250*R[4][1] + 3150*R[5][1] - 350*R[6][1] + 10*R[7][1]))/11. +
    (7*pow(a,12)*(-825*R[0][1] + 4200*R[1][1] - 8820*R[2][1] + 9800*R[3][1] - 6125*R[4][1] + 2100*R[5][1] - 350*R[6][1] + 20*R[7][1]))/6. -
    (7*pow(b,12)*(-825*R[0][1] + 4200*R[1][1] - 8820*R[2][1] + 9800*R[3][1] - 6125*R[4][1] + 2100*R[5][1] - 350*R[6][1] + 20*R[7][1]))/6. -
    (7*pow(a,13)*(-550*R[0][1] + 3150*R[1][1] - 7560*R[2][1] + 9800*R[3][1] - 7350*R[4][1] + 3150*R[5][1] - 700*R[6][1] + 60*R[7][1]))/13. +
    (7*pow(b,13)*(-550*R[0][1] + 3150*R[1][1] - 7560*R[2][1] + 9800*R[3][1] - 7350*R[4][1] + 3150*R[5][1] - 700*R[6][1] + 60*R[7][1]))/13.;



   res[8] =-14*pow(a,5)*R[0][0] + 14*pow(b,5)*R[0][0] + (7*pow(a,6)*(50*R[0][0] - 35*R[1][0]))/3. - (7*pow(b,6)*(50*R[0][0] - 35*R[1][0]))/3. - pow(a,7)*(450*R[0][0] + 7*(-90*R[1][0] + 30*R[2][0])) +
    pow(b,7)*(450*R[0][0] + 7*(-90*R[1][0] + 30*R[2][0])) + (pow(a,8)*(4200*R[0][0] + 49*(-180*R[1][0] + 120*R[2][0] - 25*R[3][0])))/4. -
    (pow(b,8)*(4200*R[0][0] + 49*(-180*R[1][0] + 120*R[2][0] - 25*R[3][0])))/4. - (7*pow(a,9)*(2100*R[0][0] - 5880*R[1][0] + 7*(840*R[2][0] - 350*R[3][0] + 50*R[4][0])))/9. +
    (7*pow(b,9)*(2100*R[0][0] - 5880*R[1][0] + 7*(840*R[2][0] - 350*R[3][0] + 50*R[4][0])))/9. + (7*pow(a,10)*(1260*R[0][0] - 4410*R[1][0] + 5880*R[2][0] - 3675*R[3][0] + 1050*R[4][0] - 105*R[5][0]))/5. -
    (7*pow(b,10)*(1260*R[0][0] - 4410*R[1][0] + 5880*R[2][0] - 3675*R[3][0] + 1050*R[4][0] - 105*R[5][0]))/5. + 35*pow(a,14)*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) -
    35*pow(b,14)*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) -
    (7*pow(a,11)*(2100*R[0][0] - 8820*R[1][0] + 14700*R[2][0] - 12250*R[3][0] + 5250*R[4][0] - 1050*R[5][0] + 70*R[6][0]))/11. +
    (7*pow(b,11)*(2100*R[0][0] - 8820*R[1][0] + 14700*R[2][0] - 12250*R[3][0] + 5250*R[4][0] - 1050*R[5][0] + 70*R[6][0]))/11. -
    (7*pow(a,13)*(450*R[0][0] - 2520*R[1][0] + 5880*R[2][0] - 7350*R[3][0] + 5250*R[4][0] - 2100*R[5][0] + 420*R[6][0] - 30*R[7][0]))/13. +
    (7*pow(b,13)*(450*R[0][0] - 2520*R[1][0] + 5880*R[2][0] - 7350*R[3][0] + 5250*R[4][0] - 2100*R[5][0] + 420*R[6][0] - 30*R[7][0]))/13. +
    (7*pow(a,12)*(600*R[0][0] - 2940*R[1][0] + 5880*R[2][0] - 6125*R[3][0] + 3500*R[4][0] - 1050*R[5][0] + 140*R[6][0] - 5*R[7][0]))/6. -
    (7*pow(b,12)*(600*R[0][0] - 2940*R[1][0] + 5880*R[2][0] - 6125*R[3][0] + 3500*R[4][0] - 1050*R[5][0] + 140*R[6][0] - 5*R[7][0]))/6. +
    15*pow(a,14)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) -
    (14*pow(a,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/3. -
    15*pow(b,14)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) +
    (14*pow(b,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/3.;




   res[9] =-14*pow(a,5)*R[0][1] + 14*pow(b,5)*R[0][1] + (7*pow(a,6)*(50*R[0][1] - 35*R[1][1]))/3. - (7*pow(b,6)*(50*R[0][1] - 35*R[1][1]))/3. - pow(a,7)*(450*R[0][1] + 7*(-90*R[1][1] + 30*R[2][1])) +
    pow(b,7)*(450*R[0][1] + 7*(-90*R[1][1] + 30*R[2][1])) + (pow(a,8)*(4200*R[0][1] + 49*(-180*R[1][1] + 120*R[2][1] - 25*R[3][1])))/4. -
    (pow(b,8)*(4200*R[0][1] + 49*(-180*R[1][1] + 120*R[2][1] - 25*R[3][1])))/4. - (7*pow(a,9)*(2100*R[0][1] - 5880*R[1][1] + 7*(840*R[2][1] - 350*R[3][1] + 50*R[4][1])))/9. +
    (7*pow(b,9)*(2100*R[0][1] - 5880*R[1][1] + 7*(840*R[2][1] - 350*R[3][1] + 50*R[4][1])))/9. + (7*pow(a,10)*(1260*R[0][1] - 4410*R[1][1] + 5880*R[2][1] - 3675*R[3][1] + 1050*R[4][1] - 105*R[5][1]))/5. -
    (7*pow(b,10)*(1260*R[0][1] - 4410*R[1][1] + 5880*R[2][1] - 3675*R[3][1] + 1050*R[4][1] - 105*R[5][1]))/5. + 35*pow(a,14)*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) -
    35*pow(b,14)*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) -
    (7*pow(a,11)*(2100*R[0][1] - 8820*R[1][1] + 14700*R[2][1] - 12250*R[3][1] + 5250*R[4][1] - 1050*R[5][1] + 70*R[6][1]))/11. +
    (7*pow(b,11)*(2100*R[0][1] - 8820*R[1][1] + 14700*R[2][1] - 12250*R[3][1] + 5250*R[4][1] - 1050*R[5][1] + 70*R[6][1]))/11. -
    (7*pow(a,13)*(450*R[0][1] - 2520*R[1][1] + 5880*R[2][1] - 7350*R[3][1] + 5250*R[4][1] - 2100*R[5][1] + 420*R[6][1] - 30*R[7][1]))/13. +
    (7*pow(b,13)*(450*R[0][1] - 2520*R[1][1] + 5880*R[2][1] - 7350*R[3][1] + 5250*R[4][1] - 2100*R[5][1] + 420*R[6][1] - 30*R[7][1]))/13. +
    (7*pow(a,12)*(600*R[0][1] - 2940*R[1][1] + 5880*R[2][1] - 6125*R[3][1] + 3500*R[4][1] - 1050*R[5][1] + 140*R[6][1] - 5*R[7][1]))/6. -
    (7*pow(b,12)*(600*R[0][1] - 2940*R[1][1] + 5880*R[2][1] - 6125*R[3][1] + 3500*R[4][1] - 1050*R[5][1] + 140*R[6][1] - 5*R[7][1]))/6. +
    15*pow(a,14)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) -
    (14*pow(a,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/3. -
    15*pow(b,14)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) +
    (14*pow(b,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/3.;




   res[10] =-7*pow(a,6)*R[0][0] + 7*pow(b,6)*R[0][0] - pow(a,7)*(-54*R[0][0] + 42*R[1][0]) + pow(b,7)*(-54*R[0][0] + 42*R[1][0]) + (pow(a,8)*(-756*R[0][0] + 49*(24*R[1][0] - 9*R[2][0])))/4. -
    (pow(b,8)*(-756*R[0][0] + 49*(24*R[1][0] - 9*R[2][0])))/4. - (7*pow(a,9)*(-504*R[0][0] + 1176*R[1][0] + 7*(-126*R[2][0] + 30*R[3][0])))/9. +
    (7*pow(b,9)*(-504*R[0][0] + 1176*R[1][0] + 7*(-126*R[2][0] + 30*R[3][0])))/9. + (7*pow(a,10)*(-378*R[0][0] + 1176*R[1][0] - 1323*R[2][0] + 630*R[3][0] - 105*R[4][0]))/5. -
    (7*pow(b,10)*(-378*R[0][0] + 1176*R[1][0] - 1323*R[2][0] + 630*R[3][0] - 105*R[4][0]))/5. - (7*pow(a,11)*(-756*R[0][0] + 2940*R[1][0] - 4410*R[2][0] + 3150*R[3][0] - 1050*R[4][0] + 126*R[5][0]))/11. +
    (7*pow(b,11)*(-756*R[0][0] + 2940*R[1][0] - 4410*R[2][0] + 3150*R[3][0] - 1050*R[4][0] + 126*R[5][0]))/11. +
    (7*pow(a,12)*(-252*R[0][0] + 1176*R[1][0] - 2205*R[2][0] + 2100*R[3][0] - 1050*R[4][0] + 252*R[5][0] - 21*R[6][0]))/6. -
    (7*pow(b,12)*(-252*R[0][0] + 1176*R[1][0] - 2205*R[2][0] + 2100*R[3][0] - 1050*R[4][0] + 252*R[5][0] - 21*R[6][0]))/6. -
    21*pow(a,14)*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) + 21*pow(b,14)*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) -
    6*pow(a,14)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) +
    (14*pow(a,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/5. +
    6*pow(b,14)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) -
    (14*pow(b,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/5. -
    (7*pow(a,13)*(-216*R[0][0] + 1176*R[1][0] - 2646*R[2][0] + 3150*R[3][0] - 2100*R[4][0] + 756*R[5][0] - 126*R[6][0] + 6*R[7][0]))/13. +
    (7*pow(b,13)*(-216*R[0][0] + 1176*R[1][0] - 2646*R[2][0] + 3150*R[3][0] - 2100*R[4][0] + 756*R[5][0] - 126*R[6][0] + 6*R[7][0]))/13.;




   res[11] =-7*pow(a,6)*R[0][1] + 7*pow(b,6)*R[0][1] - pow(a,7)*(-54*R[0][1] + 42*R[1][1]) + pow(b,7)*(-54*R[0][1] + 42*R[1][1]) + (pow(a,8)*(-756*R[0][1] + 49*(24*R[1][1] - 9*R[2][1])))/4. -
    (pow(b,8)*(-756*R[0][1] + 49*(24*R[1][1] - 9*R[2][1])))/4. - (7*pow(a,9)*(-504*R[0][1] + 1176*R[1][1] + 7*(-126*R[2][1] + 30*R[3][1])))/9. +
    (7*pow(b,9)*(-504*R[0][1] + 1176*R[1][1] + 7*(-126*R[2][1] + 30*R[3][1])))/9. + (7*pow(a,10)*(-378*R[0][1] + 1176*R[1][1] - 1323*R[2][1] + 630*R[3][1] - 105*R[4][1]))/5. -
    (7*pow(b,10)*(-378*R[0][1] + 1176*R[1][1] - 1323*R[2][1] + 630*R[3][1] - 105*R[4][1]))/5. - (7*pow(a,11)*(-756*R[0][1] + 2940*R[1][1] - 4410*R[2][1] + 3150*R[3][1] - 1050*R[4][1] + 126*R[5][1]))/11. +
    (7*pow(b,11)*(-756*R[0][1] + 2940*R[1][1] - 4410*R[2][1] + 3150*R[3][1] - 1050*R[4][1] + 126*R[5][1]))/11. +
    (7*pow(a,12)*(-252*R[0][1] + 1176*R[1][1] - 2205*R[2][1] + 2100*R[3][1] - 1050*R[4][1] + 252*R[5][1] - 21*R[6][1]))/6. -
    (7*pow(b,12)*(-252*R[0][1] + 1176*R[1][1] - 2205*R[2][1] + 2100*R[3][1] - 1050*R[4][1] + 252*R[5][1] - 21*R[6][1]))/6. -
    21*pow(a,14)*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) + 21*pow(b,14)*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) -
    6*pow(a,14)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) +
    (14*pow(a,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/5. +
    6*pow(b,14)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) -
    (14*pow(b,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/5. -
    (7*pow(a,13)*(-216*R[0][1] + 1176*R[1][1] - 2646*R[2][1] + 3150*R[3][1] - 2100*R[4][1] + 756*R[5][1] - 126*R[6][1] + 6*R[7][1]))/13. +
    (7*pow(b,13)*(-216*R[0][1] + 1176*R[1][1] - 2646*R[2][1] + 3150*R[3][1] - 2100*R[4][1] + 756*R[5][1] - 126*R[6][1] + 6*R[7][1]))/13.;




   res[12] =-2*pow(a,7)*R[0][0] + 2*pow(b,7)*R[0][0] + (pow(a,8)*(56*R[0][0] - 49*R[1][0]))/4. - (pow(b,8)*(56*R[0][0] - 49*R[1][0]))/4. - (7*pow(a,9)*(56*R[0][0] - 98*R[1][0] + 42*R[2][0]))/9. +
    (7*pow(b,9)*(56*R[0][0] - 98*R[1][0] + 42*R[2][0]))/9. + (7*pow(a,10)*(56*R[0][0] - 147*R[1][0] + 126*R[2][0] - 35*R[3][0]))/5. - (7*pow(b,10)*(56*R[0][0] - 147*R[1][0] + 126*R[2][0] - 35*R[3][0]))/5. -
    (7*pow(a,11)*(140*R[0][0] - 490*R[1][0] + 630*R[2][0] - 350*R[3][0] + 70*R[4][0]))/11. + (7*pow(b,11)*(140*R[0][0] - 490*R[1][0] + 630*R[2][0] - 350*R[3][0] + 70*R[4][0]))/11. +
    (7*pow(a,12)*(56*R[0][0] - 245*R[1][0] + 420*R[2][0] - 350*R[3][0] + 140*R[4][0] - 21*R[5][0]))/6. - (7*pow(b,12)*(56*R[0][0] - 245*R[1][0] + 420*R[2][0] - 350*R[3][0] + 140*R[4][0] - 21*R[5][0]))/6. +
    7*pow(a,14)*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) - 7*pow(b,14)*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) -
    (7*pow(a,13)*(56*R[0][0] - 294*R[1][0] + 630*R[2][0] - 700*R[3][0] + 420*R[4][0] - 126*R[5][0] + 14*R[6][0]))/13. +
    (7*pow(b,13)*(56*R[0][0] - 294*R[1][0] + 630*R[2][0] - 700*R[3][0] + 420*R[4][0] - 126*R[5][0] + 14*R[6][0]))/13. +
    pow(a,14)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) -
    (14*pow(a,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/15. -
    pow(b,14)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) +
    (14*pow(b,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/15.;



   res[13] =-2*pow(a,7)*R[0][1] + 2*pow(b,7)*R[0][1] + (pow(a,8)*(56*R[0][1] - 49*R[1][1]))/4. - (pow(b,8)*(56*R[0][1] - 49*R[1][1]))/4. - (7*pow(a,9)*(56*R[0][1] - 98*R[1][1] + 42*R[2][1]))/9. +
    (7*pow(b,9)*(56*R[0][1] - 98*R[1][1] + 42*R[2][1]))/9. + (7*pow(a,10)*(56*R[0][1] - 147*R[1][1] + 126*R[2][1] - 35*R[3][1]))/5. - (7*pow(b,10)*(56*R[0][1] - 147*R[1][1] + 126*R[2][1] - 35*R[3][1]))/5. -
    (7*pow(a,11)*(140*R[0][1] - 490*R[1][1] + 630*R[2][1] - 350*R[3][1] + 70*R[4][1]))/11. + (7*pow(b,11)*(140*R[0][1] - 490*R[1][1] + 630*R[2][1] - 350*R[3][1] + 70*R[4][1]))/11. +
    (7*pow(a,12)*(56*R[0][1] - 245*R[1][1] + 420*R[2][1] - 350*R[3][1] + 140*R[4][1] - 21*R[5][1]))/6. - (7*pow(b,12)*(56*R[0][1] - 245*R[1][1] + 420*R[2][1] - 350*R[3][1] + 140*R[4][1] - 21*R[5][1]))/6. +
    7*pow(a,14)*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) - 7*pow(b,14)*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) -
    (7*pow(a,13)*(56*R[0][1] - 294*R[1][1] + 630*R[2][1] - 700*R[3][1] + 420*R[4][1] - 126*R[5][1] + 14*R[6][1]))/13. +
    (7*pow(b,13)*(56*R[0][1] - 294*R[1][1] + 630*R[2][1] - 700*R[3][1] + 420*R[4][1] - 126*R[5][1] + 14*R[6][1]))/13. +
    pow(a,14)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) -
    (14*pow(a,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/15. -
    pow(b,14)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) +
    (14*pow(b,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/15.;



   res[14] =-(pow(a,8)*R[0][0])/4. + (pow(b,8)*R[0][0])/4. - (7*pow(a,9)*(-2*R[0][0] + 2*R[1][0]))/9. + (7*pow(b,9)*(-2*R[0][0] + 2*R[1][0]))/9. + (7*pow(a,10)*(-3*R[0][0] + 6*R[1][0] - 3*R[2][0]))/5. -
    (7*pow(b,10)*(-3*R[0][0] + 6*R[1][0] - 3*R[2][0]))/5. - (7*pow(a,11)*(-10*R[0][0] + 30*R[1][0] - 30*R[2][0] + 10*R[3][0]))/11. + (7*pow(b,11)*(-10*R[0][0] + 30*R[1][0] - 30*R[2][0] + 10*R[3][0]))/11. +
    (7*pow(a,12)*(-5*R[0][0] + 20*R[1][0] - 30*R[2][0] + 20*R[3][0] - 5*R[4][0]))/6. - (7*pow(b,12)*(-5*R[0][0] + 20*R[1][0] - 30*R[2][0] + 20*R[3][0] - 5*R[4][0]))/6. -
    (7*pow(a,13)*(-6*R[0][0] + 30*R[1][0] - 60*R[2][0] + 60*R[3][0] - 30*R[4][0] + 6*R[5][0]))/13. + (7*pow(b,13)*(-6*R[0][0] + 30*R[1][0] - 60*R[2][0] + 60*R[3][0] - 30*R[4][0] + 6*R[5][0]))/13. -
    pow(a,14)*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) + pow(b,14)*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0]) +
    (2*pow(a,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/15. -
    (2*pow(b,15)*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]))/15.;



   res[15] =-(pow(a,8)*R[0][1])/4. + (pow(b,8)*R[0][1])/4. - (7*pow(a,9)*(-2*R[0][1] + 2*R[1][1]))/9. + (7*pow(b,9)*(-2*R[0][1] + 2*R[1][1]))/9. + (7*pow(a,10)*(-3*R[0][1] + 6*R[1][1] - 3*R[2][1]))/5. -
    (7*pow(b,10)*(-3*R[0][1] + 6*R[1][1] - 3*R[2][1]))/5. - (7*pow(a,11)*(-10*R[0][1] + 30*R[1][1] - 30*R[2][1] + 10*R[3][1]))/11. + (7*pow(b,11)*(-10*R[0][1] + 30*R[1][1] - 30*R[2][1] + 10*R[3][1]))/11. +
    (7*pow(a,12)*(-5*R[0][1] + 20*R[1][1] - 30*R[2][1] + 20*R[3][1] - 5*R[4][1]))/6. - (7*pow(b,12)*(-5*R[0][1] + 20*R[1][1] - 30*R[2][1] + 20*R[3][1] - 5*R[4][1]))/6. -
    (7*pow(a,13)*(-6*R[0][1] + 30*R[1][1] - 60*R[2][1] + 60*R[3][1] - 30*R[4][1] + 6*R[5][1]))/13. + (7*pow(b,13)*(-6*R[0][1] + 30*R[1][1] - 60*R[2][1] + 60*R[3][1] - 30*R[4][1] + 6*R[5][1]))/13. -
    pow(a,14)*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) + pow(b,14)*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1]) +
    (2*pow(a,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/15. -
    (2*pow(b,15)*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]))/15.;

    for(int i=0; i<res.size(); i++) {
      res[i] *= duration;
    }
    return res;
}

/*
integrate from a to b
*/
double bezier_integrate_2d_8pts(double a, double b, vector<vectoreuc>& R, double duration) {
  double mid = -(a*pow(R[0][0],2)) + b*pow(R[0][0],2) - a*pow(R[0][1],2) + b*pow(R[0][1],2) + 7*pow(a,2)*R[0][0]*(R[0][0] - R[1][0]) - 7*pow(b,2)*R[0][0]*(R[0][0] - R[1][0]) + 7*pow(a,2)*R[0][1]*(R[0][1] - R[1][1]) -
   7*pow(b,2)*R[0][1]*(R[0][1] - R[1][1]) - (7*pow(a,3)*(13*pow(R[0][0],2) + 7*pow(R[1][0],2) + R[0][0]*(-26*R[1][0] + 6*R[2][0])))/3. +
   (7*pow(b,3)*(13*pow(R[0][0],2) + 7*pow(R[1][0],2) + R[0][0]*(-26*R[1][0] + 6*R[2][0])))/3. - (7*pow(a,3)*(13*pow(R[0][1],2) + 7*pow(R[1][1],2) + R[0][1]*(-26*R[1][1] + 6*R[2][1])))/3. +
   (7*pow(b,3)*(13*pow(R[0][1],2) + 7*pow(R[1][1],2) + R[0][1]*(-26*R[1][1] + 6*R[2][1])))/3. +
   (7*pow(a,4)*(26*pow(R[0][0],2) + 21*R[1][0]*(2*R[1][0] - R[2][0]) + R[0][0]*(-78*R[1][0] + 36*R[2][0] - 5*R[3][0])))/2. -
   (7*pow(b,4)*(26*pow(R[0][0],2) + 21*R[1][0]*(2*R[1][0] - R[2][0]) + R[0][0]*(-78*R[1][0] + 36*R[2][0] - 5*R[3][0])))/2. +
   (7*pow(a,4)*(26*pow(R[0][1],2) + 21*R[1][1]*(2*R[1][1] - R[2][1]) + R[0][1]*(-78*R[1][1] + 36*R[2][1] - 5*R[3][1])))/2. -
   (7*pow(b,4)*(26*pow(R[0][1],2) + 21*R[1][1]*(2*R[1][1] - R[2][1]) + R[0][1]*(-78*R[1][1] + 36*R[2][1] - 5*R[3][1])))/2. -
   (7*pow(a,5)*(143*pow(R[0][0],2) + 7*(66*pow(R[1][0],2) + 9*pow(R[2][0],2) + R[1][0]*(-66*R[2][0] + 10*R[3][0])) - 2*R[0][0]*(286*R[1][0] - 198*R[2][0] + 55*R[3][0] - 5*R[4][0])))/5. +
   (7*pow(b,5)*(143*pow(R[0][0],2) + 7*(66*pow(R[1][0],2) + 9*pow(R[2][0],2) + R[1][0]*(-66*R[2][0] + 10*R[3][0])) - 2*R[0][0]*(286*R[1][0] - 198*R[2][0] + 55*R[3][0] - 5*R[4][0])))/5. -
   (7*pow(a,5)*(143*pow(R[0][1],2) + 7*(66*pow(R[1][1],2) + 9*pow(R[2][1],2) + R[1][1]*(-66*R[2][1] + 10*R[3][1])) - 2*R[0][1]*(286*R[1][1] - 198*R[2][1] + 55*R[3][1] - 5*R[4][1])))/5. +
   (7*pow(b,5)*(143*pow(R[0][1],2) + 7*(66*pow(R[1][1],2) + 9*pow(R[2][1],2) + R[1][1]*(-66*R[2][1] + 10*R[3][1])) - 2*R[0][1]*(286*R[1][1] - 198*R[2][1] + 55*R[3][1] - 5*R[4][1])))/5. +
   (7*pow(a,6)*(143*pow(R[0][0],2) + 35*(22*pow(R[1][0],2) + 3*R[2][0]*(3*R[2][0] - R[3][0]) - R[1][0]*(33*R[2][0] - 10*R[3][0] + R[4][0])) +
        R[0][0]*(-715*R[1][0] + 660*R[2][0] - 275*R[3][0] + 50*R[4][0] - 3*R[5][0])))/3. -
   (7*pow(b,6)*(143*pow(R[0][0],2) + 35*(22*pow(R[1][0],2) + 3*R[2][0]*(3*R[2][0] - R[3][0]) - R[1][0]*(33*R[2][0] - 10*R[3][0] + R[4][0])) +
        R[0][0]*(-715*R[1][0] + 660*R[2][0] - 275*R[3][0] + 50*R[4][0] - 3*R[5][0])))/3. +
   (7*pow(a,6)*(143*pow(R[0][1],2) + 35*(22*pow(R[1][1],2) + 3*R[2][1]*(3*R[2][1] - R[3][1]) - R[1][1]*(33*R[2][1] - 10*R[3][1] + R[4][1])) +
        R[0][1]*(-715*R[1][1] + 660*R[2][1] - 275*R[3][1] + 50*R[4][1] - 3*R[5][1])))/3. -
   (7*pow(b,6)*(143*pow(R[0][1],2) + 35*(22*pow(R[1][1],2) + 3*R[2][1]*(3*R[2][1] - R[3][1]) - R[1][1]*(33*R[2][1] - 10*R[3][1] + R[4][1])) +
        R[0][1]*(-715*R[1][1] + 660*R[2][1] - 275*R[3][1] + 50*R[4][1] - 3*R[5][1])))/3. -
   pow(a,7)*(429*pow(R[0][0],2) + 7*(495*pow(R[1][0],2) + 5*(81*pow(R[2][0],2) + 5*pow(R[3][0],2) + 6*R[2][0]*(-9*R[3][0] + R[4][0])) + 6*R[1][0]*(-165*R[2][0] + 75*R[3][0] - 15*R[4][0] + R[5][0])) +
      2*R[0][0]*(-1287*R[1][0] + 1485*R[2][0] - 825*R[3][0] + 225*R[4][0] - 27*R[5][0] + R[6][0])) +
   pow(b,7)*(429*pow(R[0][0],2) + 7*(495*pow(R[1][0],2) + 5*(81*pow(R[2][0],2) + 5*pow(R[3][0],2) + 6*R[2][0]*(-9*R[3][0] + R[4][0])) + 6*R[1][0]*(-165*R[2][0] + 75*R[3][0] - 15*R[4][0] + R[5][0])) +
      2*R[0][0]*(-1287*R[1][0] + 1485*R[2][0] - 825*R[3][0] + 225*R[4][0] - 27*R[5][0] + R[6][0])) -
   pow(a,7)*(429*pow(R[0][1],2) + 7*(495*pow(R[1][1],2) + 5*(81*pow(R[2][1],2) + 5*pow(R[3][1],2) + 6*R[2][1]*(-9*R[3][1] + R[4][1])) + 6*R[1][1]*(-165*R[2][1] + 75*R[3][1] - 15*R[4][1] + R[5][1])) +
      2*R[0][1]*(-1287*R[1][1] + 1485*R[2][1] - 825*R[3][1] + 225*R[4][1] - 27*R[5][1] + R[6][1])) +
   pow(b,7)*(429*pow(R[0][1],2) + 7*(495*pow(R[1][1],2) + 5*(81*pow(R[2][1],2) + 5*pow(R[3][1],2) + 6*R[2][1]*(-9*R[3][1] + R[4][1])) + 6*R[1][1]*(-165*R[2][1] + 75*R[3][1] - 15*R[4][1] + R[5][1])) +
      2*R[0][1]*(-1287*R[1][1] + 1485*R[2][1] - 825*R[3][1] + 225*R[4][1] - 27*R[5][1] + R[6][1])) +
   pow(a,14)*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0])*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) -
   pow(b,14)*(R[0][0] - 6*R[1][0] + 15*R[2][0] - 20*R[3][0] + 15*R[4][0] - 6*R[5][0] + R[6][0])*(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0]) -
   (pow(a,15)*pow(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0],2))/15. +
   (pow(b,15)*pow(R[0][0] - 7*R[1][0] + 21*R[2][0] - 35*R[3][0] + 35*R[4][0] - 21*R[5][0] + 7*R[6][0] - R[7][0],2))/15. +
   (7*pow(a,10)*(143*pow(R[0][0],2) + 2772*pow(R[1][0],2) + 7938*pow(R[2][0],2) - 13230*R[2][0]*R[3][0] + 4900*pow(R[3][0],2) + 5880*R[2][0]*R[4][0] - 3675*R[3][0]*R[4][0] + 525*pow(R[4][0],2) -
        1323*R[2][0]*R[5][0] + 630*R[3][0]*R[5][0] - 105*R[4][0]*R[5][0] + 126*R[2][0]*R[6][0] - 35*R[3][0]*R[6][0] +
        R[0][0]*(-1287*R[1][0] + 2376*R[2][0] - 2310*R[3][0] + 1260*R[4][0] - 378*R[5][0] + 56*R[6][0] - 3*R[7][0]) - 3*R[1][0]*(3234*R[2][0] - 2940*R[3][0] + 1470*R[4][0] - 392*R[5][0] + 49*R[6][0] - 2*R[7][0]) -
        3*R[2][0]*R[7][0]))/5. - (7*pow(b,10)*(143*pow(R[0][0],2) + 2772*pow(R[1][0],2) + 7938*pow(R[2][0],2) - 13230*R[2][0]*R[3][0] + 4900*pow(R[3][0],2) + 5880*R[2][0]*R[4][0] - 3675*R[3][0]*R[4][0] +
        525*pow(R[4][0],2) - 1323*R[2][0]*R[5][0] + 630*R[3][0]*R[5][0] - 105*R[4][0]*R[5][0] + 126*R[2][0]*R[6][0] - 35*R[3][0]*R[6][0] +
        R[0][0]*(-1287*R[1][0] + 2376*R[2][0] - 2310*R[3][0] + 1260*R[4][0] - 378*R[5][0] + 56*R[6][0] - 3*R[7][0]) - 3*R[1][0]*(3234*R[2][0] - 2940*R[3][0] + 1470*R[4][0] - 392*R[5][0] + 49*R[6][0] - 2*R[7][0]) -
        3*R[2][0]*R[7][0]))/5. + (pow(a,8)*(1716*pow(R[0][0],2) + 49*(396*pow(R[1][0],2) + 540*pow(R[2][0],2) + 25*R[3][0]*(4*R[3][0] - R[4][0]) - 3*R[2][0]*(180*R[3][0] - 40*R[4][0] + 3*R[5][0]) -
           R[1][0]*(990*R[2][0] - 600*R[3][0] + 180*R[4][0] - 24*R[5][0] + R[6][0])) - R[0][0]*(12012*R[1][0] - 16632*R[2][0] + 11550*R[3][0] - 4200*R[4][0] + 756*R[5][0] - 56*R[6][0] + R[7][0])))/4. -
   (pow(b,8)*(1716*pow(R[0][0],2) + 49*(396*pow(R[1][0],2) + 540*pow(R[2][0],2) + 25*R[3][0]*(4*R[3][0] - R[4][0]) - 3*R[2][0]*(180*R[3][0] - 40*R[4][0] + 3*R[5][0]) -
           R[1][0]*(990*R[2][0] - 600*R[3][0] + 180*R[4][0] - 24*R[5][0] + R[6][0])) - R[0][0]*(12012*R[1][0] - 16632*R[2][0] + 11550*R[3][0] - 4200*R[4][0] + 756*R[5][0] - 56*R[6][0] + R[7][0])))/4. -
   (7*pow(a,9)*(429*pow(R[0][0],2) + 6468*pow(R[1][0],2) + 7*(1890*pow(R[2][0],2) + 700*pow(R[3][0],2) + 25*pow(R[4][0],2) + 5*R[3][0]*(-70*R[4][0] + 6*R[5][0]) -
           6*R[2][0]*(420*R[3][0] - 140*R[4][0] + 21*R[5][0] - R[6][0])) - 2*R[1][0]*(9702*R[2][0] - 7350*R[3][0] + 2940*R[4][0] - 588*R[5][0] + 49*R[6][0] - R[7][0]) -
        2*R[0][0]*(1716*R[1][0] - 2772*R[2][0] + 2310*R[3][0] - 1050*R[4][0] + 252*R[5][0] - 28*R[6][0] + R[7][0])))/9. +
   (7*pow(b,9)*(429*pow(R[0][0],2) + 6468*pow(R[1][0],2) + 7*(1890*pow(R[2][0],2) + 700*pow(R[3][0],2) + 25*pow(R[4][0],2) + 5*R[3][0]*(-70*R[4][0] + 6*R[5][0]) -
           6*R[2][0]*(420*R[3][0] - 140*R[4][0] + 21*R[5][0] - R[6][0])) - 2*R[1][0]*(9702*R[2][0] - 7350*R[3][0] + 2940*R[4][0] - 588*R[5][0] + 49*R[6][0] - R[7][0]) -
        2*R[0][0]*(1716*R[1][0] - 2772*R[2][0] + 2310*R[3][0] - 1050*R[4][0] + 252*R[5][0] - 28*R[6][0] + R[7][0])))/9. -
   (7*pow(a,13)*(13*pow(R[0][0],2) + 462*pow(R[1][0],2) + 2835*pow(R[2][0],2) - 7560*R[2][0]*R[3][0] + 4900*pow(R[3][0],2) + 5880*R[2][0]*R[4][0] - 7350*R[3][0]*R[4][0] + 2625*pow(R[4][0],2) -
        2646*R[2][0]*R[5][0] + 3150*R[3][0]*R[5][0] - 2100*R[4][0]*R[5][0] + 378*pow(R[5][0],2) + 630*R[2][0]*R[6][0] - 700*R[3][0]*R[6][0] + 420*R[4][0]*R[6][0] - 126*R[5][0]*R[6][0] + 7*pow(R[6][0],2) -
        6*R[1][0]*(385*R[2][0] - 525*R[3][0] + 420*R[4][0] - 196*R[5][0] + 49*R[6][0] - 5*R[7][0]) - 60*R[2][0]*R[7][0] + 60*R[3][0]*R[7][0] - 30*R[4][0]*R[7][0] + 6*R[5][0]*R[7][0] -
        2*R[0][0]*(78*R[1][0] - 198*R[2][0] + 275*R[3][0] - 225*R[4][0] + 108*R[5][0] - 28*R[6][0] + 3*R[7][0])))/13. +
   (7*pow(b,13)*(13*pow(R[0][0],2) + 462*pow(R[1][0],2) + 2835*pow(R[2][0],2) - 7560*R[2][0]*R[3][0] + 4900*pow(R[3][0],2) + 5880*R[2][0]*R[4][0] - 7350*R[3][0]*R[4][0] + 2625*pow(R[4][0],2) -
        2646*R[2][0]*R[5][0] + 3150*R[3][0]*R[5][0] - 2100*R[4][0]*R[5][0] + 378*pow(R[5][0],2) + 630*R[2][0]*R[6][0] - 700*R[3][0]*R[6][0] + 420*R[4][0]*R[6][0] - 126*R[5][0]*R[6][0] + 7*pow(R[6][0],2) -
        6*R[1][0]*(385*R[2][0] - 525*R[3][0] + 420*R[4][0] - 196*R[5][0] + 49*R[6][0] - 5*R[7][0]) - 60*R[2][0]*R[7][0] + 60*R[3][0]*R[7][0] - 30*R[4][0]*R[7][0] + 6*R[5][0]*R[7][0] -
        2*R[0][0]*(78*R[1][0] - 198*R[2][0] + 275*R[3][0] - 225*R[4][0] + 108*R[5][0] - 28*R[6][0] + 3*R[7][0])))/13. -
   (7*pow(a,11)*(143*pow(R[0][0],2) + 3465*pow(R[1][0],2) + 13230*pow(R[2][0],2) - 26460*R[2][0]*R[3][0] + 12250*pow(R[3][0],2) + 14700*R[2][0]*R[4][0] - 12250*R[3][0]*R[4][0] + 2625*pow(R[4][0],2) -
        4410*R[2][0]*R[5][0] + 3150*R[3][0]*R[5][0] - 1050*R[4][0]*R[5][0] + 63*pow(R[5][0],2) + 630*R[2][0]*R[6][0] - 350*R[3][0]*R[6][0] + 70*R[4][0]*R[6][0] -
        10*R[1][0]*(1386*R[2][0] - 1470*R[3][0] + 882*R[4][0] - 294*R[5][0] + 49*R[6][0] - 3*R[7][0]) - 30*R[2][0]*R[7][0] + 10*R[3][0]*R[7][0] -
        2*R[0][0]*(715*R[1][0] - 1485*R[2][0] + 1650*R[3][0] - 1050*R[4][0] + 378*R[5][0] - 70*R[6][0] + 5*R[7][0])))/11. +
   (7*pow(b,11)*(143*pow(R[0][0],2) + 3465*pow(R[1][0],2) + 13230*pow(R[2][0],2) - 26460*R[2][0]*R[3][0] + 12250*pow(R[3][0],2) + 14700*R[2][0]*R[4][0] - 12250*R[3][0]*R[4][0] + 2625*pow(R[4][0],2) -
        4410*R[2][0]*R[5][0] + 3150*R[3][0]*R[5][0] - 1050*R[4][0]*R[5][0] + 63*pow(R[5][0],2) + 630*R[2][0]*R[6][0] - 350*R[3][0]*R[6][0] + 70*R[4][0]*R[6][0] -
        10*R[1][0]*(1386*R[2][0] - 1470*R[3][0] + 882*R[4][0] - 294*R[5][0] + 49*R[6][0] - 3*R[7][0]) - 30*R[2][0]*R[7][0] + 10*R[3][0]*R[7][0] -
        2*R[0][0]*(715*R[1][0] - 1485*R[2][0] + 1650*R[3][0] - 1050*R[4][0] + 378*R[5][0] - 70*R[6][0] + 5*R[7][0])))/11. +
   (7*pow(a,12)*(26*pow(R[0][0],2) + 770*pow(R[1][0],2) + 3780*pow(R[2][0],2) - 8820*R[2][0]*R[3][0] + 4900*pow(R[3][0],2) + 5880*R[2][0]*R[4][0] - 6125*R[3][0]*R[4][0] + 1750*pow(R[4][0],2) -
        2205*R[2][0]*R[5][0] + 2100*R[3][0]*R[5][0] - 1050*R[4][0]*R[5][0] + 126*pow(R[5][0],2) + 420*R[2][0]*R[6][0] - 350*R[3][0]*R[6][0] + 140*R[4][0]*R[6][0] - 21*R[5][0]*R[6][0] +
        R[0][0]*(-286*R[1][0] + 660*R[2][0] - 825*R[3][0] + 600*R[4][0] - 252*R[5][0] + 56*R[6][0] - 5*R[7][0]) - 30*R[2][0]*R[7][0] + 20*R[3][0]*R[7][0] - 5*R[4][0]*R[7][0] +
        R[1][0]*(-3465*R[2][0] + 4200*R[3][0] - 2940*R[4][0] + 1176*R[5][0] - 245*R[6][0] + 20*R[7][0])))/6. -
   (7*pow(b,12)*(26*pow(R[0][0],2) + 770*pow(R[1][0],2) + 3780*pow(R[2][0],2) - 8820*R[2][0]*R[3][0] + 4900*pow(R[3][0],2) + 5880*R[2][0]*R[4][0] - 6125*R[3][0]*R[4][0] + 1750*pow(R[4][0],2) -
        2205*R[2][0]*R[5][0] + 2100*R[3][0]*R[5][0] - 1050*R[4][0]*R[5][0] + 126*pow(R[5][0],2) + 420*R[2][0]*R[6][0] - 350*R[3][0]*R[6][0] + 140*R[4][0]*R[6][0] - 21*R[5][0]*R[6][0] +
        R[0][0]*(-286*R[1][0] + 660*R[2][0] - 825*R[3][0] + 600*R[4][0] - 252*R[5][0] + 56*R[6][0] - 5*R[7][0]) - 30*R[2][0]*R[7][0] + 20*R[3][0]*R[7][0] - 5*R[4][0]*R[7][0] +
        R[1][0]*(-3465*R[2][0] + 4200*R[3][0] - 2940*R[4][0] + 1176*R[5][0] - 245*R[6][0] + 20*R[7][0])))/6. +
   pow(a,14)*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1])*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) -
   pow(b,14)*(R[0][1] - 6*R[1][1] + 15*R[2][1] - 20*R[3][1] + 15*R[4][1] - 6*R[5][1] + R[6][1])*(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1]) -
   (pow(a,15)*pow(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1],2))/15. +
   (pow(b,15)*pow(R[0][1] - 7*R[1][1] + 21*R[2][1] - 35*R[3][1] + 35*R[4][1] - 21*R[5][1] + 7*R[6][1] - R[7][1],2))/15. +
   (7*pow(a,10)*(143*pow(R[0][1],2) + 2772*pow(R[1][1],2) + 7938*pow(R[2][1],2) - 13230*R[2][1]*R[3][1] + 4900*pow(R[3][1],2) + 5880*R[2][1]*R[4][1] - 3675*R[3][1]*R[4][1] + 525*pow(R[4][1],2) -
        1323*R[2][1]*R[5][1] + 630*R[3][1]*R[5][1] - 105*R[4][1]*R[5][1] + 126*R[2][1]*R[6][1] - 35*R[3][1]*R[6][1] +
        R[0][1]*(-1287*R[1][1] + 2376*R[2][1] - 2310*R[3][1] + 1260*R[4][1] - 378*R[5][1] + 56*R[6][1] - 3*R[7][1]) - 3*R[1][1]*(3234*R[2][1] - 2940*R[3][1] + 1470*R[4][1] - 392*R[5][1] + 49*R[6][1] - 2*R[7][1]) -
        3*R[2][1]*R[7][1]))/5. - (7*pow(b,10)*(143*pow(R[0][1],2) + 2772*pow(R[1][1],2) + 7938*pow(R[2][1],2) - 13230*R[2][1]*R[3][1] + 4900*pow(R[3][1],2) + 5880*R[2][1]*R[4][1] - 3675*R[3][1]*R[4][1] +
        525*pow(R[4][1],2) - 1323*R[2][1]*R[5][1] + 630*R[3][1]*R[5][1] - 105*R[4][1]*R[5][1] + 126*R[2][1]*R[6][1] - 35*R[3][1]*R[6][1] +
        R[0][1]*(-1287*R[1][1] + 2376*R[2][1] - 2310*R[3][1] + 1260*R[4][1] - 378*R[5][1] + 56*R[6][1] - 3*R[7][1]) - 3*R[1][1]*(3234*R[2][1] - 2940*R[3][1] + 1470*R[4][1] - 392*R[5][1] + 49*R[6][1] - 2*R[7][1]) -
        3*R[2][1]*R[7][1]))/5. + (pow(a,8)*(1716*pow(R[0][1],2) + 49*(396*pow(R[1][1],2) + 540*pow(R[2][1],2) + 25*R[3][1]*(4*R[3][1] - R[4][1]) - 3*R[2][1]*(180*R[3][1] - 40*R[4][1] + 3*R[5][1]) -
           R[1][1]*(990*R[2][1] - 600*R[3][1] + 180*R[4][1] - 24*R[5][1] + R[6][1])) - R[0][1]*(12012*R[1][1] - 16632*R[2][1] + 11550*R[3][1] - 4200*R[4][1] + 756*R[5][1] - 56*R[6][1] + R[7][1])))/4. -
   (pow(b,8)*(1716*pow(R[0][1],2) + 49*(396*pow(R[1][1],2) + 540*pow(R[2][1],2) + 25*R[3][1]*(4*R[3][1] - R[4][1]) - 3*R[2][1]*(180*R[3][1] - 40*R[4][1] + 3*R[5][1]) -
           R[1][1]*(990*R[2][1] - 600*R[3][1] + 180*R[4][1] - 24*R[5][1] + R[6][1])) - R[0][1]*(12012*R[1][1] - 16632*R[2][1] + 11550*R[3][1] - 4200*R[4][1] + 756*R[5][1] - 56*R[6][1] + R[7][1])))/4. -
   (7*pow(a,9)*(429*pow(R[0][1],2) + 6468*pow(R[1][1],2) + 7*(1890*pow(R[2][1],2) + 700*pow(R[3][1],2) + 25*pow(R[4][1],2) + 5*R[3][1]*(-70*R[4][1] + 6*R[5][1]) -
           6*R[2][1]*(420*R[3][1] - 140*R[4][1] + 21*R[5][1] - R[6][1])) - 2*R[1][1]*(9702*R[2][1] - 7350*R[3][1] + 2940*R[4][1] - 588*R[5][1] + 49*R[6][1] - R[7][1]) -
        2*R[0][1]*(1716*R[1][1] - 2772*R[2][1] + 2310*R[3][1] - 1050*R[4][1] + 252*R[5][1] - 28*R[6][1] + R[7][1])))/9. +
   (7*pow(b,9)*(429*pow(R[0][1],2) + 6468*pow(R[1][1],2) + 7*(1890*pow(R[2][1],2) + 700*pow(R[3][1],2) + 25*pow(R[4][1],2) + 5*R[3][1]*(-70*R[4][1] + 6*R[5][1]) -
           6*R[2][1]*(420*R[3][1] - 140*R[4][1] + 21*R[5][1] - R[6][1])) - 2*R[1][1]*(9702*R[2][1] - 7350*R[3][1] + 2940*R[4][1] - 588*R[5][1] + 49*R[6][1] - R[7][1]) -
        2*R[0][1]*(1716*R[1][1] - 2772*R[2][1] + 2310*R[3][1] - 1050*R[4][1] + 252*R[5][1] - 28*R[6][1] + R[7][1])))/9. -
   (7*pow(a,13)*(13*pow(R[0][1],2) + 462*pow(R[1][1],2) + 2835*pow(R[2][1],2) - 7560*R[2][1]*R[3][1] + 4900*pow(R[3][1],2) + 5880*R[2][1]*R[4][1] - 7350*R[3][1]*R[4][1] + 2625*pow(R[4][1],2) -
        2646*R[2][1]*R[5][1] + 3150*R[3][1]*R[5][1] - 2100*R[4][1]*R[5][1] + 378*pow(R[5][1],2) + 630*R[2][1]*R[6][1] - 700*R[3][1]*R[6][1] + 420*R[4][1]*R[6][1] - 126*R[5][1]*R[6][1] + 7*pow(R[6][1],2) -
        6*R[1][1]*(385*R[2][1] - 525*R[3][1] + 420*R[4][1] - 196*R[5][1] + 49*R[6][1] - 5*R[7][1]) - 60*R[2][1]*R[7][1] + 60*R[3][1]*R[7][1] - 30*R[4][1]*R[7][1] + 6*R[5][1]*R[7][1] -
        2*R[0][1]*(78*R[1][1] - 198*R[2][1] + 275*R[3][1] - 225*R[4][1] + 108*R[5][1] - 28*R[6][1] + 3*R[7][1])))/13. +
   (7*pow(b,13)*(13*pow(R[0][1],2) + 462*pow(R[1][1],2) + 2835*pow(R[2][1],2) - 7560*R[2][1]*R[3][1] + 4900*pow(R[3][1],2) + 5880*R[2][1]*R[4][1] - 7350*R[3][1]*R[4][1] + 2625*pow(R[4][1],2) -
        2646*R[2][1]*R[5][1] + 3150*R[3][1]*R[5][1] - 2100*R[4][1]*R[5][1] + 378*pow(R[5][1],2) + 630*R[2][1]*R[6][1] - 700*R[3][1]*R[6][1] + 420*R[4][1]*R[6][1] - 126*R[5][1]*R[6][1] + 7*pow(R[6][1],2) -
        6*R[1][1]*(385*R[2][1] - 525*R[3][1] + 420*R[4][1] - 196*R[5][1] + 49*R[6][1] - 5*R[7][1]) - 60*R[2][1]*R[7][1] + 60*R[3][1]*R[7][1] - 30*R[4][1]*R[7][1] + 6*R[5][1]*R[7][1] -
        2*R[0][1]*(78*R[1][1] - 198*R[2][1] + 275*R[3][1] - 225*R[4][1] + 108*R[5][1] - 28*R[6][1] + 3*R[7][1])))/13. -
   (7*pow(a,11)*(143*pow(R[0][1],2) + 3465*pow(R[1][1],2) + 13230*pow(R[2][1],2) - 26460*R[2][1]*R[3][1] + 12250*pow(R[3][1],2) + 14700*R[2][1]*R[4][1] - 12250*R[3][1]*R[4][1] + 2625*pow(R[4][1],2) -
        4410*R[2][1]*R[5][1] + 3150*R[3][1]*R[5][1] - 1050*R[4][1]*R[5][1] + 63*pow(R[5][1],2) + 630*R[2][1]*R[6][1] - 350*R[3][1]*R[6][1] + 70*R[4][1]*R[6][1] -
        10*R[1][1]*(1386*R[2][1] - 1470*R[3][1] + 882*R[4][1] - 294*R[5][1] + 49*R[6][1] - 3*R[7][1]) - 30*R[2][1]*R[7][1] + 10*R[3][1]*R[7][1] -
        2*R[0][1]*(715*R[1][1] - 1485*R[2][1] + 1650*R[3][1] - 1050*R[4][1] + 378*R[5][1] - 70*R[6][1] + 5*R[7][1])))/11. +
   (7*pow(b,11)*(143*pow(R[0][1],2) + 3465*pow(R[1][1],2) + 13230*pow(R[2][1],2) - 26460*R[2][1]*R[3][1] + 12250*pow(R[3][1],2) + 14700*R[2][1]*R[4][1] - 12250*R[3][1]*R[4][1] + 2625*pow(R[4][1],2) -
        4410*R[2][1]*R[5][1] + 3150*R[3][1]*R[5][1] - 1050*R[4][1]*R[5][1] + 63*pow(R[5][1],2) + 630*R[2][1]*R[6][1] - 350*R[3][1]*R[6][1] + 70*R[4][1]*R[6][1] -
        10*R[1][1]*(1386*R[2][1] - 1470*R[3][1] + 882*R[4][1] - 294*R[5][1] + 49*R[6][1] - 3*R[7][1]) - 30*R[2][1]*R[7][1] + 10*R[3][1]*R[7][1] -
        2*R[0][1]*(715*R[1][1] - 1485*R[2][1] + 1650*R[3][1] - 1050*R[4][1] + 378*R[5][1] - 70*R[6][1] + 5*R[7][1])))/11. +
   (7*pow(a,12)*(26*pow(R[0][1],2) + 770*pow(R[1][1],2) + 3780*pow(R[2][1],2) - 8820*R[2][1]*R[3][1] + 4900*pow(R[3][1],2) + 5880*R[2][1]*R[4][1] - 6125*R[3][1]*R[4][1] + 1750*pow(R[4][1],2) -
        2205*R[2][1]*R[5][1] + 2100*R[3][1]*R[5][1] - 1050*R[4][1]*R[5][1] + 126*pow(R[5][1],2) + 420*R[2][1]*R[6][1] - 350*R[3][1]*R[6][1] + 140*R[4][1]*R[6][1] - 21*R[5][1]*R[6][1] +
        R[0][1]*(-286*R[1][1] + 660*R[2][1] - 825*R[3][1] + 600*R[4][1] - 252*R[5][1] + 56*R[6][1] - 5*R[7][1]) - 30*R[2][1]*R[7][1] + 20*R[3][1]*R[7][1] - 5*R[4][1]*R[7][1] +
        R[1][1]*(-3465*R[2][1] + 4200*R[3][1] - 2940*R[4][1] + 1176*R[5][1] - 245*R[6][1] + 20*R[7][1])))/6. -
   (7*pow(b,12)*(26*pow(R[0][1],2) + 770*pow(R[1][1],2) + 3780*pow(R[2][1],2) - 8820*R[2][1]*R[3][1] + 4900*pow(R[3][1],2) + 5880*R[2][1]*R[4][1] - 6125*R[3][1]*R[4][1] + 1750*pow(R[4][1],2) -
        2205*R[2][1]*R[5][1] + 2100*R[3][1]*R[5][1] - 1050*R[4][1]*R[5][1] + 126*pow(R[5][1],2) + 420*R[2][1]*R[6][1] - 350*R[3][1]*R[6][1] + 140*R[4][1]*R[6][1] - 21*R[5][1]*R[6][1] +
        R[0][1]*(-286*R[1][1] + 660*R[2][1] - 825*R[3][1] + 600*R[4][1] - 252*R[5][1] + 56*R[6][1] - 5*R[7][1]) - 30*R[2][1]*R[7][1] + 20*R[3][1]*R[7][1] - 5*R[4][1]*R[7][1] +
        R[1][1]*(-3465*R[2][1] + 4200*R[3][1] - 2940*R[4][1] + 1176*R[5][1] - 245*R[6][1] + 20*R[7][1])))/6;
        return mid*duration;
}


vector<vector<vector<double> > > _2d8ptsgrads; // 2d8ptsgrads[i][n] gives gradient for nth gradient ith dimension
void bezier_2d_8pts_continuity(const double* P, const double* Q, int n, vector<vector<double> >& grad, double* result) {
  static int pd = 2;
  static int pts = 8;
  if(_2d8ptsgrads.size() == 0) {
    _2d8ptsgrads.resize(pd);
    for(int i=0; i<pd; i++) {
      _2d8ptsgrads[i].resize(pts);
    }
    _2d8ptsgrads[1][0] = vector<double>{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    _2d8ptsgrads[0][1] = vector<double>{0,0,0,0,0,0,0,0,0,0,0,0,-7,0,7,0,7,0,-7,0,0,0,0,0,0,0,0,0,0,0,0,0};
    _2d8ptsgrads[0][0] = vector<double>{0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    _2d8ptsgrads[1][1] = vector<double>{0,0,0,0,0,0,0,0,0,0,0,0,0,-7,0,7,0,7,0,-7,0,0,0,0,0,0,0,0,0,0,0,0};
    _2d8ptsgrads[0][2] = vector<double>{0,0,0,0,0,0,0,0,0,0,42,0,-84,0,42,0,-42,0,84,0,-42,0,0,0,0,0,0,0,0,0,0,0};
    _2d8ptsgrads[1][2] = vector<double>{0,0,0,0,0,0,0,0,0,0,0,42,0,-84,0,42,0,-42,0,84,0,-42,0,0,0,0,0,0,0,0,0,0};
    _2d8ptsgrads[0][3] = vector<double>{0,0,0,0,0,0,0,0,-210,0,630,0,-630,0,210,0,210,0,-630,0,630,0,-210,0,0,0,0,0,0,0,0,0};
    _2d8ptsgrads[1][3] = vector<double>{0,0,0,0,0,0,0,0,0,-210,0,630,0,-630,0,210,0,210,0,-630,0,630,0,-210,0,0,0,0,0,0,0,0};
    _2d8ptsgrads[0][4] = vector<double>{0,0,0,0,0,0,840,0,-3360,0,5040,0,-3360,0,840,0,-840,0,3360,0,-5040,0,3360,0,-840,0,0,0,0,0,0,0};
    _2d8ptsgrads[1][4] = vector<double>{0,0,0,0,0,0,0,840,0,-3360,0,5040,0,-3360,0,840,0,-840,0,3360,0,-5040,0,3360,0,-840,0,0,0,0,0,0};
    _2d8ptsgrads[0][5] = vector<double>{0,0,0,0,-2520,0,12600,0,-25200,0,25200,0,-12600,0,2520,0,2520,0,-12600,0,25200,0,-25200,0,12600,0,-2520,0,0,0,0,0};
    _2d8ptsgrads[1][5] = vector<double>{0,0,0,0,0,-2520,0,12600,0,-25200,0,25200,0,-12600,0,2520,0,2520,0,-12600,0,25200,0,-25200,0,12600,0,-2520,0,0,0,0};
    _2d8ptsgrads[0][6] = vector<double>{0,0,5040,0,-30240,0,75600,0,-100800,0,75600,0,-30240,0,5040,0,-5040,0,30240,0,-75600,0,100800,0,-75600,0,30240,0,-5040,0,0,0};
    _2d8ptsgrads[1][6] = vector<double>{0,0,0,5040,0,-30240,0,75600,0,-100800,0,75600,0,-30240,0,5040,0,-5040,0,30240,0,-75600,0,100800,0,-75600,0,30240,0,-5040,0,0};
    _2d8ptsgrads[0][7] = vector<double>{-5040,0,35280,0,-105840,0,176400,0,-176400,0,105840,0,-35280,0,5040,0,5040,0,-35280,0,105840,0,-176400,0,176400,0,-105840,0,35280,0,-5040,0};
    _2d8ptsgrads[1][7] = vector<double>{0,-5040,0,35280,0,-105840,0,176400,0,-176400,0,105840,0,-35280,0,5040,0,5040,0,-35280,0,105840,0,-176400,0,176400,0,-105840,0,35280,0,-5040};
  }

  if(grad.size() > 0) {
    for(int i=0; i<pd; i++) {
      grad[i] = _2d8ptsgrads[i][n];
    }
  }



  for(int i=0; i<pd; i++)
    result[i] = 0;
  for(int i=0; i<pd; i++) {
    for(int j=0; j<pts; j++) {
      result[i] += _2d8ptsgrads[i][n][pd*j+i] * P[pd*j+i];
      result[i] += _2d8ptsgrads[i][n][pd*pts + pd*j+i] * Q[pd*j+i];
    }
  }

}

double bezier_2d_8pts_continuity_euc(vector<double>& P, vector<double>& Q, int n, vector<double>& grad) {
  if(n == 0) {
    if(grad.size() > 0) {
      grad = vector<double>{0,0,0,0,0,0,0,0,0,0,0,0,0,0,2*(P[7*2+0] - Q[0*2+0]),
        2*(P[7*2+1] - Q[0*2+1]),-2*(P[7*2+0] - Q[0*2+0]),-2*(P[7*2+1] - Q[0*2+1]),
        0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    }
    return pow(P[7*2+0] - Q[0*2+0],2) + pow(P[7*2+1] - Q[0*2+1],2);
  } else if(n == 1) {
    if(grad.size() > 0) {
      grad = vector<double>{0,0,0,0,0,0,0,0,0,0,0,0,-14*(-7*P[6*2+0] + 7*P[7*2+0] + 7*Q[0*2+0] - 7*Q[1*2+0]),
   -14*(-7*P[6*2+1] + 7*P[7*2+1] + 7*Q[0*2+1] - 7*Q[1*2+1]),
   14*(-7*P[6*2+0] + 7*P[7*2+0] + 7*Q[0*2+0] - 7*Q[1*2+0]),
   14*(-7*P[6*2+1] + 7*P[7*2+1] + 7*Q[0*2+1] - 7*Q[1*2+1]),
   14*(-7*P[6*2+0] + 7*P[7*2+0] + 7*Q[0*2+0] - 7*Q[1*2+0]),
   14*(-7*P[6*2+1] + 7*P[7*2+1] + 7*Q[0*2+1] - 7*Q[1*2+1]),
   -14*(-7*P[6*2+0] + 7*P[7*2+0] + 7*Q[0*2+0] - 7*Q[1*2+0]),
   -14*(-7*P[6*2+1] + 7*P[7*2+1] + 7*Q[0*2+1] - 7*Q[1*2+1]),0,0,0,0,0,0,0,0,0,0,0,0};
    }
    return pow(-7*P[6*2+0] + 7*P[7*2+0] + 7*Q[0*2+0] - 7*Q[1*2+0],2) + pow(-7*P[6*2+1] + 7*P[7*2+1] + 7*Q[0*2+1] - 7*Q[1*2+1],2);
  } else if(n == 2) {
    if(grad.size() > 0) {
      grad = vector<double>{0,0,0,0,0,0,0,0,0,0,84*(42*P[5*2+0] - 84*P[6*2+0] + 42*P[7*2+0] - 42*Q[0*2+0] + 84*Q[1*2+0] -
      42*Q[2*2+0]),84*(42*P[5*2+1] - 84*P[6*2+1] + 42*P[7*2+1] - 42*Q[0*2+1] + 84*Q[1*2+1] - 42*Q[2*2+1]),
   -168*(42*P[5*2+0] - 84*P[6*2+0] + 42*P[7*2+0] - 42*Q[0*2+0] + 84*Q[1*2+0] - 42*Q[2*2+0]),
   -168*(42*P[5*2+1] - 84*P[6*2+1] + 42*P[7*2+1] - 42*Q[0*2+1] + 84*Q[1*2+1] - 42*Q[2*2+1]),
   84*(42*P[5*2+0] - 84*P[6*2+0] + 42*P[7*2+0] - 42*Q[0*2+0] + 84*Q[1*2+0] - 42*Q[2*2+0]),
   84*(42*P[5*2+1] - 84*P[6*2+1] + 42*P[7*2+1] - 42*Q[0*2+1] + 84*Q[1*2+1] - 42*Q[2*2+1]),
   -84*(42*P[5*2+0] - 84*P[6*2+0] + 42*P[7*2+0] - 42*Q[0*2+0] + 84*Q[1*2+0] - 42*Q[2*2+0]),
   -84*(42*P[5*2+1] - 84*P[6*2+1] + 42*P[7*2+1] - 42*Q[0*2+1] + 84*Q[1*2+1] - 42*Q[2*2+1]),
   168*(42*P[5*2+0] - 84*P[6*2+0] + 42*P[7*2+0] - 42*Q[0*2+0] + 84*Q[1*2+0] - 42*Q[2*2+0]),
   168*(42*P[5*2+1] - 84*P[6*2+1] + 42*P[7*2+1] - 42*Q[0*2+1] + 84*Q[1*2+1] - 42*Q[2*2+1]),
   -84*(42*P[5*2+0] - 84*P[6*2+0] + 42*P[7*2+0] - 42*Q[0*2+0] + 84*Q[1*2+0] - 42*Q[2*2+0]),
   -84*(42*P[5*2+1] - 84*P[6*2+1] + 42*P[7*2+1] - 42*Q[0*2+1] + 84*Q[1*2+1] - 42*Q[2*2+1]),0,0,0,0,0,0,0,0,
   0,0};
    }
    return pow(42*P[5*2+0] - 84*P[6*2+0] + 42*P[7*2+0] - 42*Q[0*2+0] + 84*Q[1*2+0] - 42*Q[2*2+0],2) +
           pow(42*P[5*2+1] - 84*P[6*2+1] + 42*P[7*2+1] - 42*Q[0*2+1] + 84*Q[1*2+1] - 42*Q[2*2+1],2);
  } else if(n == 3) {
    if(grad.size() > 0) {
      grad = vector<double>{0,0,0,0,0,0,0,0,-420*(-210*P[4*2+0] + 630*P[5*2+0] - 630*P[6*2+0] + 210*P[7*2+0] + 210*Q[0*2+0] -
      630*Q[1*2+0] + 630*Q[2*2+0] - 210*Q[3*2+0]),
   -420*(-210*P[4*2+1] + 630*P[5*2+1] - 630*P[6*2+1] + 210*P[7*2+1] + 210*Q[0*2+1] - 630*Q[1*2+1] +
      630*Q[2*2+1] - 210*Q[3*2+1]),1260*(-210*P[4*2+0] + 630*P[5*2+0] - 630*P[6*2+0] + 210*P[7*2+0] +
      210*Q[0*2+0] - 630*Q[1*2+0] + 630*Q[2*2+0] - 210*Q[3*2+0]),
   1260*(-210*P[4*2+1] + 630*P[5*2+1] - 630*P[6*2+1] + 210*P[7*2+1] + 210*Q[0*2+1] - 630*Q[1*2+1] +
      630*Q[2*2+1] - 210*Q[3*2+1]),-1260*(-210*P[4*2+0] + 630*P[5*2+0] - 630*P[6*2+0] + 210*P[7*2+0] +
      210*Q[0*2+0] - 630*Q[1*2+0] + 630*Q[2*2+0] - 210*Q[3*2+0]),
   -1260*(-210*P[4*2+1] + 630*P[5*2+1] - 630*P[6*2+1] + 210*P[7*2+1] + 210*Q[0*2+1] - 630*Q[1*2+1] +
      630*Q[2*2+1] - 210*Q[3*2+1]),420*(-210*P[4*2+0] + 630*P[5*2+0] - 630*P[6*2+0] + 210*P[7*2+0] +
      210*Q[0*2+0] - 630*Q[1*2+0] + 630*Q[2*2+0] - 210*Q[3*2+0]),
   420*(-210*P[4*2+1] + 630*P[5*2+1] - 630*P[6*2+1] + 210*P[7*2+1] + 210*Q[0*2+1] - 630*Q[1*2+1] +
      630*Q[2*2+1] - 210*Q[3*2+1]),420*(-210*P[4*2+0] + 630*P[5*2+0] - 630*P[6*2+0] + 210*P[7*2+0] +
      210*Q[0*2+0] - 630*Q[1*2+0] + 630*Q[2*2+0] - 210*Q[3*2+0]),
   420*(-210*P[4*2+1] + 630*P[5*2+1] - 630*P[6*2+1] + 210*P[7*2+1] + 210*Q[0*2+1] - 630*Q[1*2+1] +
      630*Q[2*2+1] - 210*Q[3*2+1]),-1260*(-210*P[4*2+0] + 630*P[5*2+0] - 630*P[6*2+0] + 210*P[7*2+0] +
      210*Q[0*2+0] - 630*Q[1*2+0] + 630*Q[2*2+0] - 210*Q[3*2+0]),
   -1260*(-210*P[4*2+1] + 630*P[5*2+1] - 630*P[6*2+1] + 210*P[7*2+1] + 210*Q[0*2+1] - 630*Q[1*2+1] +
      630*Q[2*2+1] - 210*Q[3*2+1]),1260*(-210*P[4*2+0] + 630*P[5*2+0] - 630*P[6*2+0] + 210*P[7*2+0] +
      210*Q[0*2+0] - 630*Q[1*2+0] + 630*Q[2*2+0] - 210*Q[3*2+0]),
   1260*(-210*P[4*2+1] + 630*P[5*2+1] - 630*P[6*2+1] + 210*P[7*2+1] + 210*Q[0*2+1] - 630*Q[1*2+1] +
      630*Q[2*2+1] - 210*Q[3*2+1]),-420*(-210*P[4*2+0] + 630*P[5*2+0] - 630*P[6*2+0] + 210*P[7*2+0] +
      210*Q[0*2+0] - 630*Q[1*2+0] + 630*Q[2*2+0] - 210*Q[3*2+0]),
   -420*(-210*P[4*2+1] + 630*P[5*2+1] - 630*P[6*2+1] + 210*P[7*2+1] + 210*Q[0*2+1] - 630*Q[1*2+1] +
      630*Q[2*2+1] - 210*Q[3*2+1]),0,0,0,0,0,0,0,0};
    }
    return pow(-210*P[4*2+0] + 630*P[5*2+0] - 630*P[6*2+0] + 210*P[7*2+0] + 210*Q[0*2+0] - 630*Q[1*2+0] +
     630*Q[2*2+0] - 210*Q[3*2+0],2) + pow(-210*P[4*2+1] + 630*P[5*2+1] - 630*P[6*2+1] + 210*P[7*2+1] +
     210*Q[0*2+1] - 630*Q[1*2+1] + 630*Q[2*2+1] - 210*Q[3*2+1],2);
  } else if(n == 4) {
    if(grad.size() > 0) {
      grad = vector<double>{0,0,0,0,0,0,1680*(840*P[3*2+0] - 3360*P[4*2+0] + 5040*P[5*2+0] - 3360*P[6*2+0] + 840*P[7*2+0] -
      840*Q[0*2+0] + 3360*Q[1*2+0] - 5040*Q[2*2+0] + 3360*Q[3*2+0] - 840*Q[4*2+0]),
   1680*(840*P[3*2+1] - 3360*P[4*2+1] + 5040*P[5*2+1] - 3360*P[6*2+1] + 840*P[7*2+1] - 840*Q[0*2+1] +
      3360*Q[1*2+1] - 5040*Q[2*2+1] + 3360*Q[3*2+1] - 840*Q[4*2+1]),
   -6720*(840*P[3*2+0] - 3360*P[4*2+0] + 5040*P[5*2+0] - 3360*P[6*2+0] + 840*P[7*2+0] - 840*Q[0*2+0] +
      3360*Q[1*2+0] - 5040*Q[2*2+0] + 3360*Q[3*2+0] - 840*Q[4*2+0]),
   -6720*(840*P[3*2+1] - 3360*P[4*2+1] + 5040*P[5*2+1] - 3360*P[6*2+1] + 840*P[7*2+1] - 840*Q[0*2+1] +
      3360*Q[1*2+1] - 5040*Q[2*2+1] + 3360*Q[3*2+1] - 840*Q[4*2+1]),
   10080*(840*P[3*2+0] - 3360*P[4*2+0] + 5040*P[5*2+0] - 3360*P[6*2+0] + 840*P[7*2+0] - 840*Q[0*2+0] +
      3360*Q[1*2+0] - 5040*Q[2*2+0] + 3360*Q[3*2+0] - 840*Q[4*2+0]),
   10080*(840*P[3*2+1] - 3360*P[4*2+1] + 5040*P[5*2+1] - 3360*P[6*2+1] + 840*P[7*2+1] - 840*Q[0*2+1] +
      3360*Q[1*2+1] - 5040*Q[2*2+1] + 3360*Q[3*2+1] - 840*Q[4*2+1]),
   -6720*(840*P[3*2+0] - 3360*P[4*2+0] + 5040*P[5*2+0] - 3360*P[6*2+0] + 840*P[7*2+0] - 840*Q[0*2+0] +
      3360*Q[1*2+0] - 5040*Q[2*2+0] + 3360*Q[3*2+0] - 840*Q[4*2+0]),
   -6720*(840*P[3*2+1] - 3360*P[4*2+1] + 5040*P[5*2+1] - 3360*P[6*2+1] + 840*P[7*2+1] - 840*Q[0*2+1] +
      3360*Q[1*2+1] - 5040*Q[2*2+1] + 3360*Q[3*2+1] - 840*Q[4*2+1]),
   1680*(840*P[3*2+0] - 3360*P[4*2+0] + 5040*P[5*2+0] - 3360*P[6*2+0] + 840*P[7*2+0] - 840*Q[0*2+0] +
      3360*Q[1*2+0] - 5040*Q[2*2+0] + 3360*Q[3*2+0] - 840*Q[4*2+0]),
   1680*(840*P[3*2+1] - 3360*P[4*2+1] + 5040*P[5*2+1] - 3360*P[6*2+1] + 840*P[7*2+1] - 840*Q[0*2+1] +
      3360*Q[1*2+1] - 5040*Q[2*2+1] + 3360*Q[3*2+1] - 840*Q[4*2+1]),
   -1680*(840*P[3*2+0] - 3360*P[4*2+0] + 5040*P[5*2+0] - 3360*P[6*2+0] + 840*P[7*2+0] - 840*Q[0*2+0] +
      3360*Q[1*2+0] - 5040*Q[2*2+0] + 3360*Q[3*2+0] - 840*Q[4*2+0]),
   -1680*(840*P[3*2+1] - 3360*P[4*2+1] + 5040*P[5*2+1] - 3360*P[6*2+1] + 840*P[7*2+1] - 840*Q[0*2+1] +
      3360*Q[1*2+1] - 5040*Q[2*2+1] + 3360*Q[3*2+1] - 840*Q[4*2+1]),
   6720*(840*P[3*2+0] - 3360*P[4*2+0] + 5040*P[5*2+0] - 3360*P[6*2+0] + 840*P[7*2+0] - 840*Q[0*2+0] +
      3360*Q[1*2+0] - 5040*Q[2*2+0] + 3360*Q[3*2+0] - 840*Q[4*2+0]),
   6720*(840*P[3*2+1] - 3360*P[4*2+1] + 5040*P[5*2+1] - 3360*P[6*2+1] + 840*P[7*2+1] - 840*Q[0*2+1] +
      3360*Q[1*2+1] - 5040*Q[2*2+1] + 3360*Q[3*2+1] - 840*Q[4*2+1]),
   -10080*(840*P[3*2+0] - 3360*P[4*2+0] + 5040*P[5*2+0] - 3360*P[6*2+0] + 840*P[7*2+0] - 840*Q[0*2+0] +
      3360*Q[1*2+0] - 5040*Q[2*2+0] + 3360*Q[3*2+0] - 840*Q[4*2+0]),
   -10080*(840*P[3*2+1] - 3360*P[4*2+1] + 5040*P[5*2+1] - 3360*P[6*2+1] + 840*P[7*2+1] - 840*Q[0*2+1] +
      3360*Q[1*2+1] - 5040*Q[2*2+1] + 3360*Q[3*2+1] - 840*Q[4*2+1]),
   6720*(840*P[3*2+0] - 3360*P[4*2+0] + 5040*P[5*2+0] - 3360*P[6*2+0] + 840*P[7*2+0] - 840*Q[0*2+0] +
      3360*Q[1*2+0] - 5040*Q[2*2+0] + 3360*Q[3*2+0] - 840*Q[4*2+0]),
   6720*(840*P[3*2+1] - 3360*P[4*2+1] + 5040*P[5*2+1] - 3360*P[6*2+1] + 840*P[7*2+1] - 840*Q[0*2+1] +
      3360*Q[1*2+1] - 5040*Q[2*2+1] + 3360*Q[3*2+1] - 840*Q[4*2+1]),
   -1680*(840*P[3*2+0] - 3360*P[4*2+0] + 5040*P[5*2+0] - 3360*P[6*2+0] + 840*P[7*2+0] - 840*Q[0*2+0] +
      3360*Q[1*2+0] - 5040*Q[2*2+0] + 3360*Q[3*2+0] - 840*Q[4*2+0]),
   -1680*(840*P[3*2+1] - 3360*P[4*2+1] + 5040*P[5*2+1] - 3360*P[6*2+1] + 840*P[7*2+1] - 840*Q[0*2+1] +
      3360*Q[1*2+1] - 5040*Q[2*2+1] + 3360*Q[3*2+1] - 840*Q[4*2+1]),0,0,0,0,0,0};
    }
    return pow(840*P[3*2+0] - 3360*P[4*2+0] + 5040*P[5*2+0] - 3360*P[6*2+0] + 840*P[7*2+0] - 840*Q[0*2+0] +
     3360*Q[1*2+0] - 5040*Q[2*2+0] + 3360*Q[3*2+0] - 840*Q[4*2+0],2) +
   pow(840*P[3*2+1] - 3360*P[4*2+1] + 5040*P[5*2+1] - 3360*P[6*2+1] + 840*P[7*2+1] - 840*Q[0*2+1] +
     3360*Q[1*2+1] - 5040*Q[2*2+1] + 3360*Q[3*2+1] - 840*Q[4*2+1],2);
  } else if(n == 5) {
    if(grad.size() > 0) {
      grad = vector<double>{0,0,0,0,-5040*(-2520*P[2*2+0] + 12600*P[3*2+0] - 25200*P[4*2+0] + 25200*P[5*2+0] - 12600*P[6*2+0] +
      2520*P[7*2+0] + 2520*Q[0*2+0] - 12600*Q[1*2+0] + 25200*Q[2*2+0] - 25200*Q[3*2+0] + 12600*Q[4*2+0] -
      2520*Q[5*2+0]),-5040*(-2520*P[2*2+1] + 12600*P[3*2+1] - 25200*P[4*2+1] + 25200*P[5*2+1] -
      12600*P[6*2+1] + 2520*P[7*2+1] + 2520*Q[0*2+1] - 12600*Q[1*2+1] + 25200*Q[2*2+1] - 25200*Q[3*2+1] +
      12600*Q[4*2+1] - 2520*Q[5*2+1]),25200*
    (-2520*P[2*2+0] + 12600*P[3*2+0] - 25200*P[4*2+0] + 25200*P[5*2+0] - 12600*P[6*2+0] + 2520*P[7*2+0] +
      2520*Q[0*2+0] - 12600*Q[1*2+0] + 25200*Q[2*2+0] - 25200*Q[3*2+0] + 12600*Q[4*2+0] - 2520*Q[5*2+0]),
   25200*(-2520*P[2*2+1] + 12600*P[3*2+1] - 25200*P[4*2+1] + 25200*P[5*2+1] - 12600*P[6*2+1] +
      2520*P[7*2+1] + 2520*Q[0*2+1] - 12600*Q[1*2+1] + 25200*Q[2*2+1] - 25200*Q[3*2+1] + 12600*Q[4*2+1] -
      2520*Q[5*2+1]),-50400*(-2520*P[2*2+0] + 12600*P[3*2+0] - 25200*P[4*2+0] + 25200*P[5*2+0] -
      12600*P[6*2+0] + 2520*P[7*2+0] + 2520*Q[0*2+0] - 12600*Q[1*2+0] + 25200*Q[2*2+0] - 25200*Q[3*2+0] +
      12600*Q[4*2+0] - 2520*Q[5*2+0]),-50400*
    (-2520*P[2*2+1] + 12600*P[3*2+1] - 25200*P[4*2+1] + 25200*P[5*2+1] - 12600*P[6*2+1] + 2520*P[7*2+1] +
      2520*Q[0*2+1] - 12600*Q[1*2+1] + 25200*Q[2*2+1] - 25200*Q[3*2+1] + 12600*Q[4*2+1] - 2520*Q[5*2+1]),
   50400*(-2520*P[2*2+0] + 12600*P[3*2+0] - 25200*P[4*2+0] + 25200*P[5*2+0] - 12600*P[6*2+0] +
      2520*P[7*2+0] + 2520*Q[0*2+0] - 12600*Q[1*2+0] + 25200*Q[2*2+0] - 25200*Q[3*2+0] + 12600*Q[4*2+0] -
      2520*Q[5*2+0]),50400*(-2520*P[2*2+1] + 12600*P[3*2+1] - 25200*P[4*2+1] + 25200*P[5*2+1] -
      12600*P[6*2+1] + 2520*P[7*2+1] + 2520*Q[0*2+1] - 12600*Q[1*2+1] + 25200*Q[2*2+1] - 25200*Q[3*2+1] +
      12600*Q[4*2+1] - 2520*Q[5*2+1]),-25200*
    (-2520*P[2*2+0] + 12600*P[3*2+0] - 25200*P[4*2+0] + 25200*P[5*2+0] - 12600*P[6*2+0] + 2520*P[7*2+0] +
      2520*Q[0*2+0] - 12600*Q[1*2+0] + 25200*Q[2*2+0] - 25200*Q[3*2+0] + 12600*Q[4*2+0] - 2520*Q[5*2+0]),
   -25200*(-2520*P[2*2+1] + 12600*P[3*2+1] - 25200*P[4*2+1] + 25200*P[5*2+1] - 12600*P[6*2+1] +
      2520*P[7*2+1] + 2520*Q[0*2+1] - 12600*Q[1*2+1] + 25200*Q[2*2+1] - 25200*Q[3*2+1] + 12600*Q[4*2+1] -
      2520*Q[5*2+1]),5040*(-2520*P[2*2+0] + 12600*P[3*2+0] - 25200*P[4*2+0] + 25200*P[5*2+0] -
      12600*P[6*2+0] + 2520*P[7*2+0] + 2520*Q[0*2+0] - 12600*Q[1*2+0] + 25200*Q[2*2+0] - 25200*Q[3*2+0] +
      12600*Q[4*2+0] - 2520*Q[5*2+0]),5040*
    (-2520*P[2*2+1] + 12600*P[3*2+1] - 25200*P[4*2+1] + 25200*P[5*2+1] - 12600*P[6*2+1] + 2520*P[7*2+1] +
      2520*Q[0*2+1] - 12600*Q[1*2+1] + 25200*Q[2*2+1] - 25200*Q[3*2+1] + 12600*Q[4*2+1] - 2520*Q[5*2+1]),
   5040*(-2520*P[2*2+0] + 12600*P[3*2+0] - 25200*P[4*2+0] + 25200*P[5*2+0] - 12600*P[6*2+0] +
      2520*P[7*2+0] + 2520*Q[0*2+0] - 12600*Q[1*2+0] + 25200*Q[2*2+0] - 25200*Q[3*2+0] + 12600*Q[4*2+0] -
      2520*Q[5*2+0]),5040*(-2520*P[2*2+1] + 12600*P[3*2+1] - 25200*P[4*2+1] + 25200*P[5*2+1] -
      12600*P[6*2+1] + 2520*P[7*2+1] + 2520*Q[0*2+1] - 12600*Q[1*2+1] + 25200*Q[2*2+1] - 25200*Q[3*2+1] +
      12600*Q[4*2+1] - 2520*Q[5*2+1]),-25200*
    (-2520*P[2*2+0] + 12600*P[3*2+0] - 25200*P[4*2+0] + 25200*P[5*2+0] - 12600*P[6*2+0] + 2520*P[7*2+0] +
      2520*Q[0*2+0] - 12600*Q[1*2+0] + 25200*Q[2*2+0] - 25200*Q[3*2+0] + 12600*Q[4*2+0] - 2520*Q[5*2+0]),
   -25200*(-2520*P[2*2+1] + 12600*P[3*2+1] - 25200*P[4*2+1] + 25200*P[5*2+1] - 12600*P[6*2+1] +
      2520*P[7*2+1] + 2520*Q[0*2+1] - 12600*Q[1*2+1] + 25200*Q[2*2+1] - 25200*Q[3*2+1] + 12600*Q[4*2+1] -
      2520*Q[5*2+1]),50400*(-2520*P[2*2+0] + 12600*P[3*2+0] - 25200*P[4*2+0] + 25200*P[5*2+0] -
      12600*P[6*2+0] + 2520*P[7*2+0] + 2520*Q[0*2+0] - 12600*Q[1*2+0] + 25200*Q[2*2+0] - 25200*Q[3*2+0] +
      12600*Q[4*2+0] - 2520*Q[5*2+0]),50400*
    (-2520*P[2*2+1] + 12600*P[3*2+1] - 25200*P[4*2+1] + 25200*P[5*2+1] - 12600*P[6*2+1] + 2520*P[7*2+1] +
      2520*Q[0*2+1] - 12600*Q[1*2+1] + 25200*Q[2*2+1] - 25200*Q[3*2+1] + 12600*Q[4*2+1] - 2520*Q[5*2+1]),
   -50400*(-2520*P[2*2+0] + 12600*P[3*2+0] - 25200*P[4*2+0] + 25200*P[5*2+0] - 12600*P[6*2+0] +
      2520*P[7*2+0] + 2520*Q[0*2+0] - 12600*Q[1*2+0] + 25200*Q[2*2+0] - 25200*Q[3*2+0] + 12600*Q[4*2+0] -
      2520*Q[5*2+0]),-50400*(-2520*P[2*2+1] + 12600*P[3*2+1] - 25200*P[4*2+1] + 25200*P[5*2+1] -
      12600*P[6*2+1] + 2520*P[7*2+1] + 2520*Q[0*2+1] - 12600*Q[1*2+1] + 25200*Q[2*2+1] - 25200*Q[3*2+1] +
      12600*Q[4*2+1] - 2520*Q[5*2+1]),25200*
    (-2520*P[2*2+0] + 12600*P[3*2+0] - 25200*P[4*2+0] + 25200*P[5*2+0] - 12600*P[6*2+0] + 2520*P[7*2+0] +
      2520*Q[0*2+0] - 12600*Q[1*2+0] + 25200*Q[2*2+0] - 25200*Q[3*2+0] + 12600*Q[4*2+0] - 2520*Q[5*2+0]),
   25200*(-2520*P[2*2+1] + 12600*P[3*2+1] - 25200*P[4*2+1] + 25200*P[5*2+1] - 12600*P[6*2+1] +
      2520*P[7*2+1] + 2520*Q[0*2+1] - 12600*Q[1*2+1] + 25200*Q[2*2+1] - 25200*Q[3*2+1] + 12600*Q[4*2+1] -
      2520*Q[5*2+1]),-5040*(-2520*P[2*2+0] + 12600*P[3*2+0] - 25200*P[4*2+0] + 25200*P[5*2+0] -
      12600*P[6*2+0] + 2520*P[7*2+0] + 2520*Q[0*2+0] - 12600*Q[1*2+0] + 25200*Q[2*2+0] - 25200*Q[3*2+0] +
      12600*Q[4*2+0] - 2520*Q[5*2+0]),-5040*
    (-2520*P[2*2+1] + 12600*P[3*2+1] - 25200*P[4*2+1] + 25200*P[5*2+1] - 12600*P[6*2+1] + 2520*P[7*2+1] +
      2520*Q[0*2+1] - 12600*Q[1*2+1] + 25200*Q[2*2+1] - 25200*Q[3*2+1] + 12600*Q[4*2+1] - 2520*Q[5*2+1]),0,
   0,0,0};
    }
    return pow(-2520*P[2*2+0] + 12600*P[3*2+0] - 25200*P[4*2+0] + 25200*P[5*2+0] - 12600*P[6*2+0] + 2520*P[7*2+0] +
     2520*Q[0*2+0] - 12600*Q[1*2+0] + 25200*Q[2*2+0] - 25200*Q[3*2+0] + 12600*Q[4*2+0] - 2520*Q[5*2+0],2) +
   pow(-2520*P[2*2+1] + 12600*P[3*2+1] - 25200*P[4*2+1] + 25200*P[5*2+1] - 12600*P[6*2+1] +
     2520*P[7*2+1] + 2520*Q[0*2+1] - 12600*Q[1*2+1] + 25200*Q[2*2+1] - 25200*Q[3*2+1] + 12600*Q[4*2+1] -
     2520*Q[5*2+1],2);
  } else if(n == 6) {
    if(grad.size() > 0) {
      grad = vector<double>{0,0,10080*(5040*P[1*2+0] - 30240*P[2*2+0] + 75600*P[3*2+0] - 100800*P[4*2+0] + 75600*P[5*2+0] -
      30240*P[6*2+0] + 5040*P[7*2+0] - 5040*Q[0*2+0] + 30240*Q[1*2+0] - 75600*Q[2*2+0] + 100800*Q[3*2+0] -
      75600*Q[4*2+0] + 30240*Q[5*2+0] - 5040*Q[6*2+0]),
   10080*(5040*P[1*2+1] - 30240*P[2*2+1] + 75600*P[3*2+1] - 100800*P[4*2+1] + 75600*P[5*2+1] -
      30240*P[6*2+1] + 5040*P[7*2+1] - 5040*Q[0*2+1] + 30240*Q[1*2+1] - 75600*Q[2*2+1] + 100800*Q[3*2+1] -
      75600*Q[4*2+1] + 30240*Q[5*2+1] - 5040*Q[6*2+1]),
   -60480*(5040*P[1*2+0] - 30240*P[2*2+0] + 75600*P[3*2+0] - 100800*P[4*2+0] + 75600*P[5*2+0] -
      30240*P[6*2+0] + 5040*P[7*2+0] - 5040*Q[0*2+0] + 30240*Q[1*2+0] - 75600*Q[2*2+0] + 100800*Q[3*2+0] -
      75600*Q[4*2+0] + 30240*Q[5*2+0] - 5040*Q[6*2+0]),
   -60480*(5040*P[1*2+1] - 30240*P[2*2+1] + 75600*P[3*2+1] - 100800*P[4*2+1] + 75600*P[5*2+1] -
      30240*P[6*2+1] + 5040*P[7*2+1] - 5040*Q[0*2+1] + 30240*Q[1*2+1] - 75600*Q[2*2+1] + 100800*Q[3*2+1] -
      75600*Q[4*2+1] + 30240*Q[5*2+1] - 5040*Q[6*2+1]),
   151200*(5040*P[1*2+0] - 30240*P[2*2+0] + 75600*P[3*2+0] - 100800*P[4*2+0] + 75600*P[5*2+0] -
      30240*P[6*2+0] + 5040*P[7*2+0] - 5040*Q[0*2+0] + 30240*Q[1*2+0] - 75600*Q[2*2+0] + 100800*Q[3*2+0] -
      75600*Q[4*2+0] + 30240*Q[5*2+0] - 5040*Q[6*2+0]),
   151200*(5040*P[1*2+1] - 30240*P[2*2+1] + 75600*P[3*2+1] - 100800*P[4*2+1] + 75600*P[5*2+1] -
      30240*P[6*2+1] + 5040*P[7*2+1] - 5040*Q[0*2+1] + 30240*Q[1*2+1] - 75600*Q[2*2+1] + 100800*Q[3*2+1] -
      75600*Q[4*2+1] + 30240*Q[5*2+1] - 5040*Q[6*2+1]),
   -201600*(5040*P[1*2+0] - 30240*P[2*2+0] + 75600*P[3*2+0] - 100800*P[4*2+0] + 75600*P[5*2+0] -
      30240*P[6*2+0] + 5040*P[7*2+0] - 5040*Q[0*2+0] + 30240*Q[1*2+0] - 75600*Q[2*2+0] + 100800*Q[3*2+0] -
      75600*Q[4*2+0] + 30240*Q[5*2+0] - 5040*Q[6*2+0]),
   -201600*(5040*P[1*2+1] - 30240*P[2*2+1] + 75600*P[3*2+1] - 100800*P[4*2+1] + 75600*P[5*2+1] -
      30240*P[6*2+1] + 5040*P[7*2+1] - 5040*Q[0*2+1] + 30240*Q[1*2+1] - 75600*Q[2*2+1] + 100800*Q[3*2+1] -
      75600*Q[4*2+1] + 30240*Q[5*2+1] - 5040*Q[6*2+1]),
   151200*(5040*P[1*2+0] - 30240*P[2*2+0] + 75600*P[3*2+0] - 100800*P[4*2+0] + 75600*P[5*2+0] -
      30240*P[6*2+0] + 5040*P[7*2+0] - 5040*Q[0*2+0] + 30240*Q[1*2+0] - 75600*Q[2*2+0] + 100800*Q[3*2+0] -
      75600*Q[4*2+0] + 30240*Q[5*2+0] - 5040*Q[6*2+0]),
   151200*(5040*P[1*2+1] - 30240*P[2*2+1] + 75600*P[3*2+1] - 100800*P[4*2+1] + 75600*P[5*2+1] -
      30240*P[6*2+1] + 5040*P[7*2+1] - 5040*Q[0*2+1] + 30240*Q[1*2+1] - 75600*Q[2*2+1] + 100800*Q[3*2+1] -
      75600*Q[4*2+1] + 30240*Q[5*2+1] - 5040*Q[6*2+1]),
   -60480*(5040*P[1*2+0] - 30240*P[2*2+0] + 75600*P[3*2+0] - 100800*P[4*2+0] + 75600*P[5*2+0] -
      30240*P[6*2+0] + 5040*P[7*2+0] - 5040*Q[0*2+0] + 30240*Q[1*2+0] - 75600*Q[2*2+0] + 100800*Q[3*2+0] -
      75600*Q[4*2+0] + 30240*Q[5*2+0] - 5040*Q[6*2+0]),
   -60480*(5040*P[1*2+1] - 30240*P[2*2+1] + 75600*P[3*2+1] - 100800*P[4*2+1] + 75600*P[5*2+1] -
      30240*P[6*2+1] + 5040*P[7*2+1] - 5040*Q[0*2+1] + 30240*Q[1*2+1] - 75600*Q[2*2+1] + 100800*Q[3*2+1] -
      75600*Q[4*2+1] + 30240*Q[5*2+1] - 5040*Q[6*2+1]),
   10080*(5040*P[1*2+0] - 30240*P[2*2+0] + 75600*P[3*2+0] - 100800*P[4*2+0] + 75600*P[5*2+0] -
      30240*P[6*2+0] + 5040*P[7*2+0] - 5040*Q[0*2+0] + 30240*Q[1*2+0] - 75600*Q[2*2+0] + 100800*Q[3*2+0] -
      75600*Q[4*2+0] + 30240*Q[5*2+0] - 5040*Q[6*2+0]),
   10080*(5040*P[1*2+1] - 30240*P[2*2+1] + 75600*P[3*2+1] - 100800*P[4*2+1] + 75600*P[5*2+1] -
      30240*P[6*2+1] + 5040*P[7*2+1] - 5040*Q[0*2+1] + 30240*Q[1*2+1] - 75600*Q[2*2+1] + 100800*Q[3*2+1] -
      75600*Q[4*2+1] + 30240*Q[5*2+1] - 5040*Q[6*2+1]),
   -10080*(5040*P[1*2+0] - 30240*P[2*2+0] + 75600*P[3*2+0] - 100800*P[4*2+0] + 75600*P[5*2+0] -
      30240*P[6*2+0] + 5040*P[7*2+0] - 5040*Q[0*2+0] + 30240*Q[1*2+0] - 75600*Q[2*2+0] + 100800*Q[3*2+0] -
      75600*Q[4*2+0] + 30240*Q[5*2+0] - 5040*Q[6*2+0]),
   -10080*(5040*P[1*2+1] - 30240*P[2*2+1] + 75600*P[3*2+1] - 100800*P[4*2+1] + 75600*P[5*2+1] -
      30240*P[6*2+1] + 5040*P[7*2+1] - 5040*Q[0*2+1] + 30240*Q[1*2+1] - 75600*Q[2*2+1] + 100800*Q[3*2+1] -
      75600*Q[4*2+1] + 30240*Q[5*2+1] - 5040*Q[6*2+1]),
   60480*(5040*P[1*2+0] - 30240*P[2*2+0] + 75600*P[3*2+0] - 100800*P[4*2+0] + 75600*P[5*2+0] -
      30240*P[6*2+0] + 5040*P[7*2+0] - 5040*Q[0*2+0] + 30240*Q[1*2+0] - 75600*Q[2*2+0] + 100800*Q[3*2+0] -
      75600*Q[4*2+0] + 30240*Q[5*2+0] - 5040*Q[6*2+0]),
   60480*(5040*P[1*2+1] - 30240*P[2*2+1] + 75600*P[3*2+1] - 100800*P[4*2+1] + 75600*P[5*2+1] -
      30240*P[6*2+1] + 5040*P[7*2+1] - 5040*Q[0*2+1] + 30240*Q[1*2+1] - 75600*Q[2*2+1] + 100800*Q[3*2+1] -
      75600*Q[4*2+1] + 30240*Q[5*2+1] - 5040*Q[6*2+1]),
   -151200*(5040*P[1*2+0] - 30240*P[2*2+0] + 75600*P[3*2+0] - 100800*P[4*2+0] + 75600*P[5*2+0] -
      30240*P[6*2+0] + 5040*P[7*2+0] - 5040*Q[0*2+0] + 30240*Q[1*2+0] - 75600*Q[2*2+0] + 100800*Q[3*2+0] -
      75600*Q[4*2+0] + 30240*Q[5*2+0] - 5040*Q[6*2+0]),
   -151200*(5040*P[1*2+1] - 30240*P[2*2+1] + 75600*P[3*2+1] - 100800*P[4*2+1] + 75600*P[5*2+1] -
      30240*P[6*2+1] + 5040*P[7*2+1] - 5040*Q[0*2+1] + 30240*Q[1*2+1] - 75600*Q[2*2+1] + 100800*Q[3*2+1] -
      75600*Q[4*2+1] + 30240*Q[5*2+1] - 5040*Q[6*2+1]),
   201600*(5040*P[1*2+0] - 30240*P[2*2+0] + 75600*P[3*2+0] - 100800*P[4*2+0] + 75600*P[5*2+0] -
      30240*P[6*2+0] + 5040*P[7*2+0] - 5040*Q[0*2+0] + 30240*Q[1*2+0] - 75600*Q[2*2+0] + 100800*Q[3*2+0] -
      75600*Q[4*2+0] + 30240*Q[5*2+0] - 5040*Q[6*2+0]),
   201600*(5040*P[1*2+1] - 30240*P[2*2+1] + 75600*P[3*2+1] - 100800*P[4*2+1] + 75600*P[5*2+1] -
      30240*P[6*2+1] + 5040*P[7*2+1] - 5040*Q[0*2+1] + 30240*Q[1*2+1] - 75600*Q[2*2+1] + 100800*Q[3*2+1] -
      75600*Q[4*2+1] + 30240*Q[5*2+1] - 5040*Q[6*2+1]),
   -151200*(5040*P[1*2+0] - 30240*P[2*2+0] + 75600*P[3*2+0] - 100800*P[4*2+0] + 75600*P[5*2+0] -
      30240*P[6*2+0] + 5040*P[7*2+0] - 5040*Q[0*2+0] + 30240*Q[1*2+0] - 75600*Q[2*2+0] + 100800*Q[3*2+0] -
      75600*Q[4*2+0] + 30240*Q[5*2+0] - 5040*Q[6*2+0]),
   -151200*(5040*P[1*2+1] - 30240*P[2*2+1] + 75600*P[3*2+1] - 100800*P[4*2+1] + 75600*P[5*2+1] -
      30240*P[6*2+1] + 5040*P[7*2+1] - 5040*Q[0*2+1] + 30240*Q[1*2+1] - 75600*Q[2*2+1] + 100800*Q[3*2+1] -
      75600*Q[4*2+1] + 30240*Q[5*2+1] - 5040*Q[6*2+1]),
   60480*(5040*P[1*2+0] - 30240*P[2*2+0] + 75600*P[3*2+0] - 100800*P[4*2+0] + 75600*P[5*2+0] -
      30240*P[6*2+0] + 5040*P[7*2+0] - 5040*Q[0*2+0] + 30240*Q[1*2+0] - 75600*Q[2*2+0] + 100800*Q[3*2+0] -
      75600*Q[4*2+0] + 30240*Q[5*2+0] - 5040*Q[6*2+0]),
   60480*(5040*P[1*2+1] - 30240*P[2*2+1] + 75600*P[3*2+1] - 100800*P[4*2+1] + 75600*P[5*2+1] -
      30240*P[6*2+1] + 5040*P[7*2+1] - 5040*Q[0*2+1] + 30240*Q[1*2+1] - 75600*Q[2*2+1] + 100800*Q[3*2+1] -
      75600*Q[4*2+1] + 30240*Q[5*2+1] - 5040*Q[6*2+1]),
   -10080*(5040*P[1*2+0] - 30240*P[2*2+0] + 75600*P[3*2+0] - 100800*P[4*2+0] + 75600*P[5*2+0] -
      30240*P[6*2+0] + 5040*P[7*2+0] - 5040*Q[0*2+0] + 30240*Q[1*2+0] - 75600*Q[2*2+0] + 100800*Q[3*2+0] -
      75600*Q[4*2+0] + 30240*Q[5*2+0] - 5040*Q[6*2+0]),
   -10080*(5040*P[1*2+1] - 30240*P[2*2+1] + 75600*P[3*2+1] - 100800*P[4*2+1] + 75600*P[5*2+1] -
      30240*P[6*2+1] + 5040*P[7*2+1] - 5040*Q[0*2+1] + 30240*Q[1*2+1] - 75600*Q[2*2+1] + 100800*Q[3*2+1] -
      75600*Q[4*2+1] + 30240*Q[5*2+1] - 5040*Q[6*2+1]),0,0};
    }
    return pow(5040*P[1*2+0] - 30240*P[2*2+0] + 75600*P[3*2+0] - 100800*P[4*2+0] + 75600*P[5*2+0] - 30240*P[6*2+0] +
     5040*P[7*2+0] - 5040*Q[0*2+0] + 30240*Q[1*2+0] - 75600*Q[2*2+0] + 100800*Q[3*2+0] - 75600*Q[4*2+0] +
     30240*Q[5*2+0] - 5040*Q[6*2+0],2) + pow(5040*P[1*2+1] - 30240*P[2*2+1] + 75600*P[3*2+1] -
     100800*P[4*2+1] + 75600*P[5*2+1] - 30240*P[6*2+1] + 5040*P[7*2+1] - 5040*Q[0*2+1] + 30240*Q[1*2+1] -
     75600*Q[2*2+1] + 100800*Q[3*2+1] - 75600*Q[4*2+1] + 30240*Q[5*2+1] - 5040*Q[6*2+1],2);
  } else if(n == 7) {
    if(grad.size() > 0) {
      grad = vector<double>{-10080*(-5040*P[0*2+0] + 35280*P[1*2+0] - 105840*P[2*2+0] + 176400*P[3*2+0] - 176400*P[4*2+0] +
      105840*P[5*2+0] - 35280*P[6*2+0] + 5040*P[7*2+0] + 5040*Q[0*2+0] - 35280*Q[1*2+0] + 105840*Q[2*2+0] -
      176400*Q[3*2+0] + 176400*Q[4*2+0] - 105840*Q[5*2+0] + 35280*Q[6*2+0] - 5040*Q[7*2+0]),
   -10080*(-5040*P[0*2+1] + 35280*P[1*2+1] - 105840*P[2*2+1] + 176400*P[3*2+1] - 176400*P[4*2+1] +
      105840*P[5*2+1] - 35280*P[6*2+1] + 5040*P[7*2+1] + 5040*Q[0*2+1] - 35280*Q[1*2+1] + 105840*Q[2*2+1] -
      176400*Q[3*2+1] + 176400*Q[4*2+1] - 105840*Q[5*2+1] + 35280*Q[6*2+1] - 5040*Q[7*2+1]),
   70560*(-5040*P[0*2+0] + 35280*P[1*2+0] - 105840*P[2*2+0] + 176400*P[3*2+0] - 176400*P[4*2+0] +
      105840*P[5*2+0] - 35280*P[6*2+0] + 5040*P[7*2+0] + 5040*Q[0*2+0] - 35280*Q[1*2+0] + 105840*Q[2*2+0] -
      176400*Q[3*2+0] + 176400*Q[4*2+0] - 105840*Q[5*2+0] + 35280*Q[6*2+0] - 5040*Q[7*2+0]),
   70560*(-5040*P[0*2+1] + 35280*P[1*2+1] - 105840*P[2*2+1] + 176400*P[3*2+1] - 176400*P[4*2+1] +
      105840*P[5*2+1] - 35280*P[6*2+1] + 5040*P[7*2+1] + 5040*Q[0*2+1] - 35280*Q[1*2+1] + 105840*Q[2*2+1] -
      176400*Q[3*2+1] + 176400*Q[4*2+1] - 105840*Q[5*2+1] + 35280*Q[6*2+1] - 5040*Q[7*2+1]),
   -211680*(-5040*P[0*2+0] + 35280*P[1*2+0] - 105840*P[2*2+0] + 176400*P[3*2+0] - 176400*P[4*2+0] +
      105840*P[5*2+0] - 35280*P[6*2+0] + 5040*P[7*2+0] + 5040*Q[0*2+0] - 35280*Q[1*2+0] + 105840*Q[2*2+0] -
      176400*Q[3*2+0] + 176400*Q[4*2+0] - 105840*Q[5*2+0] + 35280*Q[6*2+0] - 5040*Q[7*2+0]),
   -211680*(-5040*P[0*2+1] + 35280*P[1*2+1] - 105840*P[2*2+1] + 176400*P[3*2+1] - 176400*P[4*2+1] +
      105840*P[5*2+1] - 35280*P[6*2+1] + 5040*P[7*2+1] + 5040*Q[0*2+1] - 35280*Q[1*2+1] + 105840*Q[2*2+1] -
      176400*Q[3*2+1] + 176400*Q[4*2+1] - 105840*Q[5*2+1] + 35280*Q[6*2+1] - 5040*Q[7*2+1]),
   352800*(-5040*P[0*2+0] + 35280*P[1*2+0] - 105840*P[2*2+0] + 176400*P[3*2+0] - 176400*P[4*2+0] +
      105840*P[5*2+0] - 35280*P[6*2+0] + 5040*P[7*2+0] + 5040*Q[0*2+0] - 35280*Q[1*2+0] + 105840*Q[2*2+0] -
      176400*Q[3*2+0] + 176400*Q[4*2+0] - 105840*Q[5*2+0] + 35280*Q[6*2+0] - 5040*Q[7*2+0]),
   352800*(-5040*P[0*2+1] + 35280*P[1*2+1] - 105840*P[2*2+1] + 176400*P[3*2+1] - 176400*P[4*2+1] +
      105840*P[5*2+1] - 35280*P[6*2+1] + 5040*P[7*2+1] + 5040*Q[0*2+1] - 35280*Q[1*2+1] + 105840*Q[2*2+1] -
      176400*Q[3*2+1] + 176400*Q[4*2+1] - 105840*Q[5*2+1] + 35280*Q[6*2+1] - 5040*Q[7*2+1]),
   -352800*(-5040*P[0*2+0] + 35280*P[1*2+0] - 105840*P[2*2+0] + 176400*P[3*2+0] - 176400*P[4*2+0] +
      105840*P[5*2+0] - 35280*P[6*2+0] + 5040*P[7*2+0] + 5040*Q[0*2+0] - 35280*Q[1*2+0] + 105840*Q[2*2+0] -
      176400*Q[3*2+0] + 176400*Q[4*2+0] - 105840*Q[5*2+0] + 35280*Q[6*2+0] - 5040*Q[7*2+0]),
   -352800*(-5040*P[0*2+1] + 35280*P[1*2+1] - 105840*P[2*2+1] + 176400*P[3*2+1] - 176400*P[4*2+1] +
      105840*P[5*2+1] - 35280*P[6*2+1] + 5040*P[7*2+1] + 5040*Q[0*2+1] - 35280*Q[1*2+1] + 105840*Q[2*2+1] -
      176400*Q[3*2+1] + 176400*Q[4*2+1] - 105840*Q[5*2+1] + 35280*Q[6*2+1] - 5040*Q[7*2+1]),
   211680*(-5040*P[0*2+0] + 35280*P[1*2+0] - 105840*P[2*2+0] + 176400*P[3*2+0] - 176400*P[4*2+0] +
      105840*P[5*2+0] - 35280*P[6*2+0] + 5040*P[7*2+0] + 5040*Q[0*2+0] - 35280*Q[1*2+0] + 105840*Q[2*2+0] -
      176400*Q[3*2+0] + 176400*Q[4*2+0] - 105840*Q[5*2+0] + 35280*Q[6*2+0] - 5040*Q[7*2+0]),
   211680*(-5040*P[0*2+1] + 35280*P[1*2+1] - 105840*P[2*2+1] + 176400*P[3*2+1] - 176400*P[4*2+1] +
      105840*P[5*2+1] - 35280*P[6*2+1] + 5040*P[7*2+1] + 5040*Q[0*2+1] - 35280*Q[1*2+1] + 105840*Q[2*2+1] -
      176400*Q[3*2+1] + 176400*Q[4*2+1] - 105840*Q[5*2+1] + 35280*Q[6*2+1] - 5040*Q[7*2+1]),
   -70560*(-5040*P[0*2+0] + 35280*P[1*2+0] - 105840*P[2*2+0] + 176400*P[3*2+0] - 176400*P[4*2+0] +
      105840*P[5*2+0] - 35280*P[6*2+0] + 5040*P[7*2+0] + 5040*Q[0*2+0] - 35280*Q[1*2+0] + 105840*Q[2*2+0] -
      176400*Q[3*2+0] + 176400*Q[4*2+0] - 105840*Q[5*2+0] + 35280*Q[6*2+0] - 5040*Q[7*2+0]),
   -70560*(-5040*P[0*2+1] + 35280*P[1*2+1] - 105840*P[2*2+1] + 176400*P[3*2+1] - 176400*P[4*2+1] +
      105840*P[5*2+1] - 35280*P[6*2+1] + 5040*P[7*2+1] + 5040*Q[0*2+1] - 35280*Q[1*2+1] + 105840*Q[2*2+1] -
      176400*Q[3*2+1] + 176400*Q[4*2+1] - 105840*Q[5*2+1] + 35280*Q[6*2+1] - 5040*Q[7*2+1]),
   10080*(-5040*P[0*2+0] + 35280*P[1*2+0] - 105840*P[2*2+0] + 176400*P[3*2+0] - 176400*P[4*2+0] +
      105840*P[5*2+0] - 35280*P[6*2+0] + 5040*P[7*2+0] + 5040*Q[0*2+0] - 35280*Q[1*2+0] + 105840*Q[2*2+0] -
      176400*Q[3*2+0] + 176400*Q[4*2+0] - 105840*Q[5*2+0] + 35280*Q[6*2+0] - 5040*Q[7*2+0]),
   10080*(-5040*P[0*2+1] + 35280*P[1*2+1] - 105840*P[2*2+1] + 176400*P[3*2+1] - 176400*P[4*2+1] +
      105840*P[5*2+1] - 35280*P[6*2+1] + 5040*P[7*2+1] + 5040*Q[0*2+1] - 35280*Q[1*2+1] + 105840*Q[2*2+1] -
      176400*Q[3*2+1] + 176400*Q[4*2+1] - 105840*Q[5*2+1] + 35280*Q[6*2+1] - 5040*Q[7*2+1]),
   10080*(-5040*P[0*2+0] + 35280*P[1*2+0] - 105840*P[2*2+0] + 176400*P[3*2+0] - 176400*P[4*2+0] +
      105840*P[5*2+0] - 35280*P[6*2+0] + 5040*P[7*2+0] + 5040*Q[0*2+0] - 35280*Q[1*2+0] + 105840*Q[2*2+0] -
      176400*Q[3*2+0] + 176400*Q[4*2+0] - 105840*Q[5*2+0] + 35280*Q[6*2+0] - 5040*Q[7*2+0]),
   10080*(-5040*P[0*2+1] + 35280*P[1*2+1] - 105840*P[2*2+1] + 176400*P[3*2+1] - 176400*P[4*2+1] +
      105840*P[5*2+1] - 35280*P[6*2+1] + 5040*P[7*2+1] + 5040*Q[0*2+1] - 35280*Q[1*2+1] + 105840*Q[2*2+1] -
      176400*Q[3*2+1] + 176400*Q[4*2+1] - 105840*Q[5*2+1] + 35280*Q[6*2+1] - 5040*Q[7*2+1]),
   -70560*(-5040*P[0*2+0] + 35280*P[1*2+0] - 105840*P[2*2+0] + 176400*P[3*2+0] - 176400*P[4*2+0] +
      105840*P[5*2+0] - 35280*P[6*2+0] + 5040*P[7*2+0] + 5040*Q[0*2+0] - 35280*Q[1*2+0] + 105840*Q[2*2+0] -
      176400*Q[3*2+0] + 176400*Q[4*2+0] - 105840*Q[5*2+0] + 35280*Q[6*2+0] - 5040*Q[7*2+0]),
   -70560*(-5040*P[0*2+1] + 35280*P[1*2+1] - 105840*P[2*2+1] + 176400*P[3*2+1] - 176400*P[4*2+1] +
      105840*P[5*2+1] - 35280*P[6*2+1] + 5040*P[7*2+1] + 5040*Q[0*2+1] - 35280*Q[1*2+1] + 105840*Q[2*2+1] -
      176400*Q[3*2+1] + 176400*Q[4*2+1] - 105840*Q[5*2+1] + 35280*Q[6*2+1] - 5040*Q[7*2+1]),
   211680*(-5040*P[0*2+0] + 35280*P[1*2+0] - 105840*P[2*2+0] + 176400*P[3*2+0] - 176400*P[4*2+0] +
      105840*P[5*2+0] - 35280*P[6*2+0] + 5040*P[7*2+0] + 5040*Q[0*2+0] - 35280*Q[1*2+0] + 105840*Q[2*2+0] -
      176400*Q[3*2+0] + 176400*Q[4*2+0] - 105840*Q[5*2+0] + 35280*Q[6*2+0] - 5040*Q[7*2+0]),
   211680*(-5040*P[0*2+1] + 35280*P[1*2+1] - 105840*P[2*2+1] + 176400*P[3*2+1] - 176400*P[4*2+1] +
      105840*P[5*2+1] - 35280*P[6*2+1] + 5040*P[7*2+1] + 5040*Q[0*2+1] - 35280*Q[1*2+1] + 105840*Q[2*2+1] -
      176400*Q[3*2+1] + 176400*Q[4*2+1] - 105840*Q[5*2+1] + 35280*Q[6*2+1] - 5040*Q[7*2+1]),
   -352800*(-5040*P[0*2+0] + 35280*P[1*2+0] - 105840*P[2*2+0] + 176400*P[3*2+0] - 176400*P[4*2+0] +
      105840*P[5*2+0] - 35280*P[6*2+0] + 5040*P[7*2+0] + 5040*Q[0*2+0] - 35280*Q[1*2+0] + 105840*Q[2*2+0] -
      176400*Q[3*2+0] + 176400*Q[4*2+0] - 105840*Q[5*2+0] + 35280*Q[6*2+0] - 5040*Q[7*2+0]),
   -352800*(-5040*P[0*2+1] + 35280*P[1*2+1] - 105840*P[2*2+1] + 176400*P[3*2+1] - 176400*P[4*2+1] +
      105840*P[5*2+1] - 35280*P[6*2+1] + 5040*P[7*2+1] + 5040*Q[0*2+1] - 35280*Q[1*2+1] + 105840*Q[2*2+1] -
      176400*Q[3*2+1] + 176400*Q[4*2+1] - 105840*Q[5*2+1] + 35280*Q[6*2+1] - 5040*Q[7*2+1]),
   352800*(-5040*P[0*2+0] + 35280*P[1*2+0] - 105840*P[2*2+0] + 176400*P[3*2+0] - 176400*P[4*2+0] +
      105840*P[5*2+0] - 35280*P[6*2+0] + 5040*P[7*2+0] + 5040*Q[0*2+0] - 35280*Q[1*2+0] + 105840*Q[2*2+0] -
      176400*Q[3*2+0] + 176400*Q[4*2+0] - 105840*Q[5*2+0] + 35280*Q[6*2+0] - 5040*Q[7*2+0]),
   352800*(-5040*P[0*2+1] + 35280*P[1*2+1] - 105840*P[2*2+1] + 176400*P[3*2+1] - 176400*P[4*2+1] +
      105840*P[5*2+1] - 35280*P[6*2+1] + 5040*P[7*2+1] + 5040*Q[0*2+1] - 35280*Q[1*2+1] + 105840*Q[2*2+1] -
      176400*Q[3*2+1] + 176400*Q[4*2+1] - 105840*Q[5*2+1] + 35280*Q[6*2+1] - 5040*Q[7*2+1]),
   -211680*(-5040*P[0*2+0] + 35280*P[1*2+0] - 105840*P[2*2+0] + 176400*P[3*2+0] - 176400*P[4*2+0] +
      105840*P[5*2+0] - 35280*P[6*2+0] + 5040*P[7*2+0] + 5040*Q[0*2+0] - 35280*Q[1*2+0] + 105840*Q[2*2+0] -
      176400*Q[3*2+0] + 176400*Q[4*2+0] - 105840*Q[5*2+0] + 35280*Q[6*2+0] - 5040*Q[7*2+0]),
   -211680*(-5040*P[0*2+1] + 35280*P[1*2+1] - 105840*P[2*2+1] + 176400*P[3*2+1] - 176400*P[4*2+1] +
      105840*P[5*2+1] - 35280*P[6*2+1] + 5040*P[7*2+1] + 5040*Q[0*2+1] - 35280*Q[1*2+1] + 105840*Q[2*2+1] -
      176400*Q[3*2+1] + 176400*Q[4*2+1] - 105840*Q[5*2+1] + 35280*Q[6*2+1] - 5040*Q[7*2+1]),
   70560*(-5040*P[0*2+0] + 35280*P[1*2+0] - 105840*P[2*2+0] + 176400*P[3*2+0] - 176400*P[4*2+0] +
      105840*P[5*2+0] - 35280*P[6*2+0] + 5040*P[7*2+0] + 5040*Q[0*2+0] - 35280*Q[1*2+0] + 105840*Q[2*2+0] -
      176400*Q[3*2+0] + 176400*Q[4*2+0] - 105840*Q[5*2+0] + 35280*Q[6*2+0] - 5040*Q[7*2+0]),
   70560*(-5040*P[0*2+1] + 35280*P[1*2+1] - 105840*P[2*2+1] + 176400*P[3*2+1] - 176400*P[4*2+1] +
      105840*P[5*2+1] - 35280*P[6*2+1] + 5040*P[7*2+1] + 5040*Q[0*2+1] - 35280*Q[1*2+1] + 105840*Q[2*2+1] -
      176400*Q[3*2+1] + 176400*Q[4*2+1] - 105840*Q[5*2+1] + 35280*Q[6*2+1] - 5040*Q[7*2+1]),
   -10080*(-5040*P[0*2+0] + 35280*P[1*2+0] - 105840*P[2*2+0] + 176400*P[3*2+0] - 176400*P[4*2+0] +
      105840*P[5*2+0] - 35280*P[6*2+0] + 5040*P[7*2+0] + 5040*Q[0*2+0] - 35280*Q[1*2+0] + 105840*Q[2*2+0] -
      176400*Q[3*2+0] + 176400*Q[4*2+0] - 105840*Q[5*2+0] + 35280*Q[6*2+0] - 5040*Q[7*2+0]),
   -10080*(-5040*P[0*2+1] + 35280*P[1*2+1] - 105840*P[2*2+1] + 176400*P[3*2+1] - 176400*P[4*2+1] +
      105840*P[5*2+1] - 35280*P[6*2+1] + 5040*P[7*2+1] + 5040*Q[0*2+1] - 35280*Q[1*2+1] + 105840*Q[2*2+1] -
      176400*Q[3*2+1] + 176400*Q[4*2+1] - 105840*Q[5*2+1] + 35280*Q[6*2+1] - 5040*Q[7*2+1])};
    }
    return pow(-5040*P[0*2+0] + 35280*P[1*2+0] - 105840*P[2*2+0] + 176400*P[3*2+0] - 176400*P[4*2+0] +
     105840*P[5*2+0] - 35280*P[6*2+0] + 5040*P[7*2+0] + 5040*Q[0*2+0] - 35280*Q[1*2+0] + 105840*Q[2*2+0] -
     176400*Q[3*2+0] + 176400*Q[4*2+0] - 105840*Q[5*2+0] + 35280*Q[6*2+0] - 5040*Q[7*2+0],2) +
   pow(-5040*P[0*2+1] + 35280*P[1*2+1] - 105840*P[2*2+1] + 176400*P[3*2+1] - 176400*P[4*2+1] +
     105840*P[5*2+1] - 35280*P[6*2+1] + 5040*P[7*2+1] + 5040*Q[0*2+1] - 35280*Q[1*2+1] + 105840*Q[2*2+1] -
     176400*Q[3*2+1] + 176400*Q[4*2+1] - 105840*Q[5*2+1] + 35280*Q[6*2+1] - 5040*Q[7*2+1],2);
  }

  if(grad.size() > 0) {
    grad = vector<double>{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
  }
  return 0;
}

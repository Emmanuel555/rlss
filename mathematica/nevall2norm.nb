(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     10233,        243]
NotebookOptionsPosition[      9497,        222]
NotebookOutlinePosition[      9836,        237]
CellTagsIndexPosition[      9793,        234]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"d", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", "7"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "t_", "]"}], " ", ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"i", ",", "j"}], "]"}], "*", 
        RowBox[{"Binomial", "[", 
         RowBox[{"d", ",", "i"}], "]"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t", "/", "dur"}], ")"}], "^", "i"}], "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{"t", "/", "dur"}], ")"}]}], ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"d", "-", "i"}], ")"}]}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "d"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", 
       RowBox[{"Q", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g", "[", "t_", "]"}], " ", ":=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", "t", "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"t", ",", "n"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sq", " ", "=", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"g", "[", "t", "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}], "^", "2"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "Q"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"grad", " ", "=", " ", 
   RowBox[{"Grad", "[", 
    RowBox[{"sq", ",", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"i", ",", "j"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "d"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", 
          RowBox[{"Q", "-", "1"}]}], "}"}]}], "]"}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7312618338264637`*^9, 3.731262082270177*^9}, {
  3.7312622389781523`*^9, 3.7312622392966537`*^9}, {3.7312622743192377`*^9, 
  3.731262274456366*^9}, {3.731262304844129*^9, 3.7312623115110283`*^9}, {
  3.731262355576252*^9, 3.731262355668153*^9}, {3.7312624068145227`*^9, 
  3.731262406979619*^9}, {3.731262451691778*^9, 3.731262451789234*^9}, {
  3.73126248815292*^9, 3.731262488235319*^9}, {3.7312625242399683`*^9, 
  3.731262524301279*^9}},ExpressionUUID->"ca96822a-005e-42bb-95cc-\
565f86c02ed9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", "sq", "]"}]], "Input",
 CellChangeTimes->{{3.731262033436346*^9, 
  3.731262035065634*^9}},ExpressionUUID->"baeee6c2-63a8-4a39-8408-\
ab60add2ffe5"],

Cell["\<\
Power((-5040*P(0,0))/Power(dur,7) + (35280*P(1,0))/Power(dur,7) - \
(105840*P(2,0))/Power(dur,7) + (176400*P(3,0))/Power(dur,7) - \
(176400*P(4,0))/Power(dur,7) + (105840*P(5,0))/Power(dur,7) - 
     (35280*P(6,0))/Power(dur,7) + (5040*P(7,0))/Power(dur,7),2) + \
Power((-5040*P(0,1))/Power(dur,7) + (35280*P(1,1))/Power(dur,7) - \
(105840*P(2,1))/Power(dur,7) + (176400*P(3,1))/Power(dur,7) - 
     (176400*P(4,1))/Power(dur,7) + (105840*P(5,1))/Power(dur,7) - \
(35280*P(6,1))/Power(dur,7) + (5040*P(7,1))/Power(dur,7),2)\
\>", "Output",
 CellChangeTimes->{{3.7312620660683413`*^9, 3.7312620779918823`*^9}, 
   3.731262143477477*^9, 3.731262241458634*^9, 3.7312622773285513`*^9, {
   3.731262307442595*^9, 3.731262358663907*^9}, {3.73126240940729*^9, 
   3.731262454664507*^9}, 3.731262490606863*^9, {3.731262527652315*^9, 
   3.731262534412455*^9}},ExpressionUUID->"50a1ae56-5356-4c2f-a640-\
0a99c360d3a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", "grad", "]"}]], "Input",
 CellChangeTimes->{{3.731262045062498*^9, 
  3.73126204839167*^9}},ExpressionUUID->"1c6061a6-6c24-4afc-8756-\
dff69272adae"],

Cell["\<\
List((-10080*((-5040*P(0,0))/Power(dur,7) + (35280*P(1,0))/Power(dur,7) - \
(105840*P(2,0))/Power(dur,7) + (176400*P(3,0))/Power(dur,7) - \
(176400*P(4,0))/Power(dur,7) + (105840*P(5,0))/Power(dur,7) - 
        (35280*P(6,0))/Power(dur,7) + \
(5040*P(7,0))/Power(dur,7)))/Power(dur,7),(-10080*
      ((-5040*P(0,1))/Power(dur,7) + (35280*P(1,1))/Power(dur,7) - \
(105840*P(2,1))/Power(dur,7) + (176400*P(3,1))/Power(dur,7) - \
(176400*P(4,1))/Power(dur,7) + (105840*P(5,1))/Power(dur,7) - 
        (35280*P(6,1))/Power(dur,7) + \
(5040*P(7,1))/Power(dur,7)))/Power(dur,7),(70560*
      ((-5040*P(0,0))/Power(dur,7) + (35280*P(1,0))/Power(dur,7) - \
(105840*P(2,0))/Power(dur,7) + (176400*P(3,0))/Power(dur,7) - \
(176400*P(4,0))/Power(dur,7) + (105840*P(5,0))/Power(dur,7) - 
        (35280*P(6,0))/Power(dur,7) + \
(5040*P(7,0))/Power(dur,7)))/Power(dur,7),(70560*
      ((-5040*P(0,1))/Power(dur,7) + (35280*P(1,1))/Power(dur,7) - \
(105840*P(2,1))/Power(dur,7) + (176400*P(3,1))/Power(dur,7) - \
(176400*P(4,1))/Power(dur,7) + (105840*P(5,1))/Power(dur,7) - 
        (35280*P(6,1))/Power(dur,7) + \
(5040*P(7,1))/Power(dur,7)))/Power(dur,7),(-211680*
      ((-5040*P(0,0))/Power(dur,7) + (35280*P(1,0))/Power(dur,7) - \
(105840*P(2,0))/Power(dur,7) + (176400*P(3,0))/Power(dur,7) - \
(176400*P(4,0))/Power(dur,7) + (105840*P(5,0))/Power(dur,7) - 
        (35280*P(6,0))/Power(dur,7) + \
(5040*P(7,0))/Power(dur,7)))/Power(dur,7),(-211680*
      ((-5040*P(0,1))/Power(dur,7) + (35280*P(1,1))/Power(dur,7) - \
(105840*P(2,1))/Power(dur,7) + (176400*P(3,1))/Power(dur,7) - \
(176400*P(4,1))/Power(dur,7) + (105840*P(5,1))/Power(dur,7) - 
        (35280*P(6,1))/Power(dur,7) + \
(5040*P(7,1))/Power(dur,7)))/Power(dur,7),(352800*
      ((-5040*P(0,0))/Power(dur,7) + (35280*P(1,0))/Power(dur,7) - \
(105840*P(2,0))/Power(dur,7) + (176400*P(3,0))/Power(dur,7) - \
(176400*P(4,0))/Power(dur,7) + (105840*P(5,0))/Power(dur,7) - 
        (35280*P(6,0))/Power(dur,7) + \
(5040*P(7,0))/Power(dur,7)))/Power(dur,7),(352800*
      ((-5040*P(0,1))/Power(dur,7) + (35280*P(1,1))/Power(dur,7) - \
(105840*P(2,1))/Power(dur,7) + (176400*P(3,1))/Power(dur,7) - \
(176400*P(4,1))/Power(dur,7) + (105840*P(5,1))/Power(dur,7) - 
        (35280*P(6,1))/Power(dur,7) + \
(5040*P(7,1))/Power(dur,7)))/Power(dur,7),(-352800*
      ((-5040*P(0,0))/Power(dur,7) + (35280*P(1,0))/Power(dur,7) - \
(105840*P(2,0))/Power(dur,7) + (176400*P(3,0))/Power(dur,7) - \
(176400*P(4,0))/Power(dur,7) + (105840*P(5,0))/Power(dur,7) - 
        (35280*P(6,0))/Power(dur,7) + \
(5040*P(7,0))/Power(dur,7)))/Power(dur,7),(-352800*
      ((-5040*P(0,1))/Power(dur,7) + (35280*P(1,1))/Power(dur,7) - \
(105840*P(2,1))/Power(dur,7) + (176400*P(3,1))/Power(dur,7) - \
(176400*P(4,1))/Power(dur,7) + (105840*P(5,1))/Power(dur,7) - 
        (35280*P(6,1))/Power(dur,7) + \
(5040*P(7,1))/Power(dur,7)))/Power(dur,7),(211680*
      ((-5040*P(0,0))/Power(dur,7) + (35280*P(1,0))/Power(dur,7) - \
(105840*P(2,0))/Power(dur,7) + (176400*P(3,0))/Power(dur,7) - \
(176400*P(4,0))/Power(dur,7) + (105840*P(5,0))/Power(dur,7) - 
        (35280*P(6,0))/Power(dur,7) + \
(5040*P(7,0))/Power(dur,7)))/Power(dur,7),(211680*
      ((-5040*P(0,1))/Power(dur,7) + (35280*P(1,1))/Power(dur,7) - \
(105840*P(2,1))/Power(dur,7) + (176400*P(3,1))/Power(dur,7) - \
(176400*P(4,1))/Power(dur,7) + (105840*P(5,1))/Power(dur,7) - 
        (35280*P(6,1))/Power(dur,7) + \
(5040*P(7,1))/Power(dur,7)))/Power(dur,7),(-70560*
      ((-5040*P(0,0))/Power(dur,7) + (35280*P(1,0))/Power(dur,7) - \
(105840*P(2,0))/Power(dur,7) + (176400*P(3,0))/Power(dur,7) - \
(176400*P(4,0))/Power(dur,7) + (105840*P(5,0))/Power(dur,7) - 
        (35280*P(6,0))/Power(dur,7) + \
(5040*P(7,0))/Power(dur,7)))/Power(dur,7),(-70560*
      ((-5040*P(0,1))/Power(dur,7) + (35280*P(1,1))/Power(dur,7) - \
(105840*P(2,1))/Power(dur,7) + (176400*P(3,1))/Power(dur,7) - \
(176400*P(4,1))/Power(dur,7) + (105840*P(5,1))/Power(dur,7) - 
        (35280*P(6,1))/Power(dur,7) + \
(5040*P(7,1))/Power(dur,7)))/Power(dur,7),(10080*
      ((-5040*P(0,0))/Power(dur,7) + (35280*P(1,0))/Power(dur,7) - \
(105840*P(2,0))/Power(dur,7) + (176400*P(3,0))/Power(dur,7) - \
(176400*P(4,0))/Power(dur,7) + (105840*P(5,0))/Power(dur,7) - 
        (35280*P(6,0))/Power(dur,7) + \
(5040*P(7,0))/Power(dur,7)))/Power(dur,7),(10080*
      ((-5040*P(0,1))/Power(dur,7) + (35280*P(1,1))/Power(dur,7) - \
(105840*P(2,1))/Power(dur,7) + (176400*P(3,1))/Power(dur,7) - \
(176400*P(4,1))/Power(dur,7) + (105840*P(5,1))/Power(dur,7) - 
        (35280*P(6,1))/Power(dur,7) + \
(5040*P(7,1))/Power(dur,7)))/Power(dur,7))\
\>", "Output",
 CellChangeTimes->{
  3.7312620796474857`*^9, 3.731262144912883*^9, 3.7312621770982523`*^9, 
   3.7312622430562077`*^9, {3.731262308900918*^9, 3.731262491987924*^9}, {
   3.731262529511972*^9, 
   3.7312625362616653`*^9}},ExpressionUUID->"577dea3e-a3fb-478f-bd25-\
f84ef1158729"]
}, Open  ]]
},
WindowSize->{1855, 1056},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.2 for Linux x86 (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 2669, 76, 170, "Input",ExpressionUUID->"ca96822a-005e-42bb-95cc-565f86c02ed9"],
Cell[CellGroupData[{
Cell[3252, 100, 185, 4, 31, "Input",ExpressionUUID->"baeee6c2-63a8-4a39-8408-ab60add2ffe5"],
Cell[3440, 106, 919, 15, 88, "Output",ExpressionUUID->"50a1ae56-5356-4c2f-a640-0a99c360d3a1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4396, 126, 186, 4, 31, "Input",ExpressionUUID->"1c6061a6-6c24-4afc-8756-dff69272adae"],
Cell[4585, 132, 4896, 87, 639, "Output",ExpressionUUID->"577dea3e-a3fb-478f-bd25-f84ef1158729"]
}, Open  ]]
}
]
*)

